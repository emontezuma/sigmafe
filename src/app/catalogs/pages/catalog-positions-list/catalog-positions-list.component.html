<div
  class="container-animated"
  (@routingAnimation.done)="pageAnimationFinished($event)"
  @routingAnimation
>
  <ng-container *ngIf="positionsData$ | async "></ng-container>
  <ng-container *ngIf="sort$ | async "></ng-container>
  <ng-container *ngIf="toolbarClick$ | async "></ng-container>
  <ng-container *ngIf="settingsData$ | async "></ng-container>
  <ng-container *ngIf="profileData$ | async "></ng-container>
  <ng-container *ngIf="searchBox$ | async "></ng-container>
  <ng-container *ngIf="screenData$ | async "></ng-container>
  <ng-container *ngIf="animationData$ | async "></ng-container>
  <ng-container *ngIf="allPositionsToCsv$ | async "></ng-container>  

  <div
    class="positions-table"    
  >
    <table mat-table [dataSource]="positionsCatalogData" matSort>

      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngIf="!loading">{{ row.data.id }}</ng-container>
          <ng-container [ngTemplateOutlet]="skeleton"></ng-container> 
        </td>
      </ng-container>      

      
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombre de la Posicion</th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngIf="!loading">            
            <strong>{{ row.data.name }}</strong>
          </ng-container>        
          <ng-container [ngTemplateOutlet]="skeleton"></ng-container> 
        </td>
      </ng-container>

      <ng-container matColumnDef="reference">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Referencia</th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngIf="!loading">            
            <strong>{{ row.data.reference }}</strong>
          </ng-container>        
          <ng-container [ngTemplateOutlet]="skeleton"></ng-container> 
        </td>
      </ng-container>

      <ng-container matColumnDef="plant">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Planta</th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngIf="!loading">            
            <strong>{{ row.data.plant.name }}</strong>
          </ng-container>        
          <ng-container [ngTemplateOutlet]="skeleton"></ng-container> 
        </td>
      </ng-container>

      <ng-container matColumnDef="recipient">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Recipiente</th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngIf="!loading">            
            <strong>{{ row.data.recipient.name }}</strong>
          </ng-container>        
          <ng-container [ngTemplateOutlet]="skeleton"></ng-container> 
        </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Estatus</th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngIf="!loading">
            {{ row.friendlyStatus }}
          </ng-container>        
          <ng-container [ngTemplateOutlet]="skeleton"></ng-container> 
        </td>
      </ng-container>

      <ng-container matColumnDef="updatedAt">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Últ. actualización</th>
        <td mat-cell *matCellDef="let row">
          <ng-container *ngIf="!loading">
            <div>{{ row.data.updatedBy?.name }}</div>   
            <div>{{ row.data.updatedAt | date:"medium" }}</div>   
          </ng-container>        
          <ng-container [ngTemplateOutlet]="skeleton"></ng-container> 
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="positionsTableColumns; sticky: 1"></tr>
      <tr
        class="table-row"
        mat-row *matRowDef="let row;
        columns: positionsTableColumns"
        [routerLink]="['/catalogs/positions/edit/', row.data.id]"
      >
      </tr>
      <div *ngIf="!loading">
        <tr class="positions-table-mat-row" *matNoDataRow>
          <td class="positions-table__no-data" colspan="10">
            No hay registros a mostrar
          </td>
        </tr>
      </div>
    </table>

    <div class="positions-table__paginator">
      <div class="positions-table__paginator--catalog-data">
        <mat-icon class="small-icon" [svgIcon]="catalogIcon"></mat-icon>
        <div>Total registros {{ pageInfo?.totalRecords}}</div>
        <!--<div>Inactivos: {{ pageInfo.inactiveRecords}}</div>-->
        <mat-divider vertical></mat-divider>
      </div>
      <mat-paginator
        #paginator
        class="positions-table__paginator--mat"
        [length]="pageInfo?.totalRecords"
        [pageSize]="50"
        (page)="pageChange($event)"
        showFirstLastButtons
        [hidePageSize]="size === 'small'"
      > 
      </mat-paginator>
    </div>
  </div>
</div>
<ng-template #skeleton>
  <ngx-skeleton-loader
    *ngIf="loading"
    class="skeleton"
    [theme]="{ height: '24px', marginBottom: '0px', backgroundColor: 'rgba(0, 0, 0, 0.075)', }"
    count="1"
  >
  </ngx-skeleton-loader>
</ng-template>