
<div
  class="container"
  #catalogEdition
  @routingAnimation
  (@routingAnimation.done)="pageAnimationFinished($event)"
>

  <ng-container *ngIf="scroll$ | async"></ng-container>
  <ng-container *ngIf="checklistTemplate$ | async"></ng-container>  
  <ng-container *ngIf="showGoTop$ | async"></ng-container>
  <ng-container *ngIf="sensors$ | async"></ng-container>
  <ng-container *ngIf="templateTypes$ | async"></ng-container>
  <ng-container *ngIf="settingsData$ | async"></ng-container>
  <ng-container *ngIf="macros$ | async"></ng-container>
  <ng-container *ngIf="recipients$ | async"></ng-container>
  <ng-container *ngIf="genYesNoValues$ | async"></ng-container>
  <ng-container *ngIf="notificationModes$ | async"></ng-container>  
  <ng-container *ngIf="notificationChannels$ | async"></ng-container>  
  <ng-container *ngIf="toolbarClick$ | async "></ng-container>  
  <ng-container *ngIf="toolbarAnimationFinished$ | async "></ng-container>  
  <ng-container *ngIf="parameters$ | async "></ng-container>  
  <ng-container *ngIf="translations$ | async "></ng-container>  
  <ng-container *ngIf="updateChecklistTemplate$ | async "></ng-container>    
  <ng-container *ngIf="deleteChecklistTemplateTranslations$ | async "></ng-container>      
  <ng-container *ngIf="addChecklistTemplateTranslations$ | async "></ng-container>   
  <ng-container *ngIf="updateChecklistTemplateCatalog$ | async "></ng-container>      
  <ng-container *ngIf="duplicateAttachmentsList$ | async "></ng-container>        
  <ng-container *ngIf="molds$ | async "></ng-container>       
  <ng-container *ngIf="variable$ | async "></ng-container>      
  <ng-container *ngIf="approvers$ | async "></ng-container>   
  <ng-container *ngIf="states$ | async "></ng-container>   
  <ng-container *ngIf="updateChecklistTemplateLine$ | async "></ng-container>     
  <ng-container *ngIf="checklistDetailAttachments$ | async "></ng-container>  
  <ng-container *ngIf="copyChecklistTemplate$ | async "></ng-container>           

  <div @dissolve class="sticky" *ngIf="showMacros">
    <mat-card>
      <div class="card-macros">
        <div
          class="macro-element"  
          *ngFor="let macro of macros.items; let i = index"
          [innerHTML]="macro.friendlyText"
        >        
        </div>      
      </div>
      <mat-divider style="margin: 0px 10px 5px 10px;"></mat-divider>
      <div style="padding: 0px 10px 10px 10px;"><strong>Inserte en el campo el id de la macro incluyendo los corchetes. Estas macros serán sustituidas por su valor correspondiente al momento de generar el checklist.</strong></div>
    </mat-card>  
  </div>

  <mat-card class="card">
    <form
        class="layout"
        (ngSubmit)="onSubmit()"
        [formGroup]="checklistTemplateForm"
        #f="ngForm"
      >
      <mat-accordion multi>
        <mat-expansion-panel
          (opened)="panelOpenState[0] = true"
          (closed)="panelOpenState[0] = false"
          hideToggle="true"
          [expanded]="panelOpenState[0]"
        >
          <mat-expansion-panel-header
            [collapsedHeight]="'55px'"
            [ngStyle]="{
              'background-color': panelOpenState[0]
                ? 'var(--z-colors-page-shadow)'
                : 'var(--z-colors-page-card-background-color)'
            }"
          >
            <mat-panel-title>
              <mat-icon class="accordion-icon" [svgIcon]="catalogIcon">
              </mat-icon>
              <label class="accordion-label"
                >INFORMACIÓN PRINCIPAL DE LA PLANTILLA DE CHECKLIST</label
              >
            </mat-panel-title>
            <div class="icon-button-container">
              <button
                mat-icon-button
                class="icon-button open"
                aria-label="icon-button with menu icon"
              >
                <mat-icon class="icon-button">
                  {{
                    panelOpenState[0]
                      ? "keyboard_arrow_up"
                      : "keyboard_arrow_down"
                  }}
                </mat-icon>
              </button>
            </div>
          </mat-expansion-panel-header>
          <div class="grid-multiple margin-top">
            <div class="field-items">
              <mat-icon
                class="macros-icon"
                svgIcon="transcode"
                matTooltip="Este campo soporta macros"
                matTooltipClass="tooltip-general"
                matTooltipShowDelay="100"
              >
              </mat-icon>              
              <app-input-field
                [focused]="focusThisField==='name'"
                [bordered]="true"
                [formField]="checklistTemplateForm.controls.name"
                leftHint="Campo requerido"
                [fieldMaxLength]="300"
                [showRightHint]="true"
                currentErrorMessage="Este campo no puede estar vacío"
                currentErrorIcon="warn_line"
                [showCloseButton]="true"
                fieldHelp="Especifique el nombre asignadoa la variable"
                [initialFocus]="true"                
              >
                <span fieldTitle class="label field__label"
                  >Descripción/Nombre del checklist</span
                >
              </app-input-field>
            </div>
            <div class="field-items">
              <app-input-field
                [focused]="focusThisField==='prefix'"
                [bordered]="true"
                [formField]="checklistTemplateForm.controls.prefix"
                leftHint="Campo requerido"
                [fieldMaxLength]="50"
                [showRightHint]="true"                
                [showCloseButton]="true"
                fieldHelp="Especifique la abreviación de la plantilla de checklist"
                [initialFocus]="true"                
              >
                <span fieldTitle class="label field__label"
                  >Abreviación de la plantilla de checklist</span
                >
              </app-input-field>
            </div>
            <div class="field-items">
              <app-input-field
                [bordered]="true"
                [formField]="checklistTemplateForm.controls.reference"
                leftHint="Campo opcional"
                [fieldMaxLength]="100"
                [showRightHint]="true"
                [showCloseButton]="true"
                fieldHelp="Especifique la referencia de la plantilla de checklist"
              >
                <span fieldTitle class="label field__label"
                  >Referencia</span
                >
              </app-input-field>
            </div>
            <div class="field-items field-items--bordered">
              <app-area-field
                [bordered]="false"
                [formField]="checklistTemplateForm.controls.notes"
                [fieldMaxLength]="500"
                [showRightHint]="true"
                [showCloseButton]="true"
                [minRows]="1"
                [maxRows]="5"
                fieldHelp="Especifique las notas referentes a esta plantilla de checklist"
              >
                <span fieldTitle class="label field__label"
                  >Notas referentes a la plantilla de checklist</span
                >
              </app-area-field>               
            </div> 
            <div class="field-items">
              <fieldset class="field__container">
                <div class="image-and-field">
                  <div class="field-components">
                    <span class="label field__label">Imagen a mostrar</span>                
                    <mat-form-field appearance="fill" class="field__field">
                      <input
                        class="field__input"
                        matInput
                        [formControl]="checklistTemplateForm.controls.mainImageName"    
                        [readonly]="true"
                      />
                      <input type="file" style="display: none" (change)="onFileSelected($event)" accept="*.png,*.jpg,*.jpeg,*.svg,*.bmp" #fileInput> 
                      <button
                        matSuffix
                        mat-icon-button
                        (click)="fileInput.click()"
                        style="margin-right: 5px;"
                        matTooltip="Abre la ventana de dialogo para buscar un archivo tipo imagen"
                        matTooltipClass="tooltip-general"
                        matTooltipShowDelay="100"
                      >
                        <mat-icon>search</mat-icon>
                      </button>
                      <button
                        *ngIf="checklistTemplate.mainImage"
                        matSuffix
                        mat-icon-button
                        (click)="removeImage()"
                        style="margin-right: 5px;"
                        matTooltip="Remueve la imagen de la plantilla de checklist"
                        matTooltipClass="tooltip-general"
                        matTooltipShowDelay="100"
                      >
                        <mat-icon>close</mat-icon>
                      </button>
                    </mat-form-field>          
                    <span class="field__help">Busque en su disco la imagen que se mostrará en las vistas de esta plantilla de checklist</span>
                  </div>                  
                  <div *ngIf="!loading" class="card-image">
                    <div
                      class="image-container"
                      *ngIf="this.checklistTemplate.mainImage"
                    >
                      <img                
                        @dissolve
                        appImageNotFound                
                        class="variable-image"    
                        [src]="this.checklistTemplate.mainImage"
                        [alt]="this.checklistTemplate.mainImage"            
                        fill
                      >      
                    </div>
                    <div
                      *ngIf="!this.checklistTemplate.mainImage"
                      class="icon-container-image"
                    >
                      <mat-icon class="default-icon" [svgIcon]="catalogIcon"></mat-icon>
                    </div>    
                  </div>
                </div>                
              </fieldset>              
            </div>
            <div class="field-items">
              <fieldset
                class="field__container"
                style="min-width: 350px; height: calc(100% - 22px);"
                [ngClass]="{
                  'field__container--error':
                    checklistTemplateForm.controls.templateType.touched &&
                    !checklistTemplateForm.controls.templateType.valid
                }"
                [disabled]="checklistTemplateForm.controls.templateType.disabled"
              >
                <div class="title-with-id">
                  <span class="label field__label">Tipo de plantilla de checklist</span>
                  <span class="field__label" *ngIf="checklistTemplateForm.controls.templateType?.value?.id">id: {{ checklistTemplateForm.controls.templateType?.value?.id }}</span>
                </div>
                <app-auto-complete-field
                  [focused]="focusThisField==='templateType'"
                  [formField]="checklistTemplateForm.controls.templateType"
                  [list]="templateTypes.items"
                  [totalCount]="templateTypes.totalCount"
                  leftHint="Escriba el Tipo de plantilla de checkliste"
                  [catalog]="SystemTables.CHECKLIST_TEMPLATE_TYPES"
                  [loading]="templateTypes.loading"
                  noItemsError="No hay Tipos de plantilla de checklist con este nombre"
                  [showDataState]="true"
                  (optionSelected)="handleOptionSelected($event)"
                  (getMoreData)="getMoreData($event)"
                >
                </app-auto-complete-field>
                <span class="field__help">Especifique el Tipo de plantilla de checklist</span>
              </fieldset>
            </div>
            <div class="field-items">
              <app-input-field
                [bordered]="true"
                [formField]="checklistTemplateForm.controls.timeToFill"
                rightHint="Campo opcional"
                fieldInputType="number"
                currentErrorIcon="warn_line"
                [showCloseButton]="true"
                [showRightHint]="true"
                leftHint="Expresado en segundos"
                fieldHelp="Indique el tiempo de promedio de llenado"
                [rightSuffix]="_sharedService.getHours(checklistTemplateForm.controls.timeToFill.value)"
              >
                <span fieldTitle class="label field__label"
                  >Tiempo aproximado de llenado</span
                >
              </app-input-field>
            </div>            
            <div class="field-items">
              <fieldset
                class="field__container"
                style="min-width: 350px; height: calc(100% - 22px);"
                [ngClass]="{
                  'field__container--error':
                    checklistTemplateForm.controls.approver.touched &&
                    !checklistTemplateForm.controls.approver.valid
                }"
                [disabled]="checklistTemplateForm.controls.approver.disabled"
              >
                <div class="title-with-id">
                  <span class="label field__label">Aprobador fijo de esta plantilla</span>
                  <span class="field__label" *ngIf="checklistTemplateForm.controls.approver?.value?.id">Id: {{ checklistTemplateForm.controls.approver?.value?.id }}</span>
                </div>
                <app-auto-complete-field
                  [focused]="focusThisField==='approver'"
                  [formField]="checklistTemplateForm.controls.approver"
                  [list]="approvers.items"
                  [totalCount]="approvers.totalCount"
                  leftHint="Escriba el nombre del aprobador a buscar"
                  [catalog]="SystemTables.USERS"
                  [loading]="approvers.loading"
                  noItemsError="No hay plantas con este nombre"
                  [showDataState]="true"
                  (optionSelected)="handleOptionSelected($event)"
                  (getMoreData)="getMoreData($event)"
                >
                </app-auto-complete-field>
                <span class="field__help"
                  >Especifique el Nombre del aprobador asignado para estas plantilla de checklist. este aprobador no se podrá modificar salvo suplencias</span
                >
              </fieldset>
            </div>

          </div>          
        </mat-expansion-panel>
        <mat-expansion-panel
          (opened)="panelOpenState[1] = true"
          (closed)="panelOpenState[1] = false"
          hideToggle="true"
          [expanded]="panelOpenState[1]"
        >
          <mat-expansion-panel-header
            [collapsedHeight]="'55px'"
            [ngStyle]="{
              'background-color': panelOpenState[1]
                ? 'var(--z-colors-page-shadow)'
                : 'var(--z-colors-page-card-background-color)'
            }"
          >
            <mat-panel-title>
              <mat-icon class="accordion-icon" svgIcon="time"> </mat-icon>
              <label class="accordion-label">USO GENERAL DE LA PLANTILLA DE CHECKLIST</label>
            </mat-panel-title>
            <div class="icon-button-container">
              <button
                mat-icon-button
                class="icon-button open"
                aria-label="icon-button with menu icon"
              >
                <mat-icon class="icon-button">
                  {{
                    panelOpenState[1]
                      ? "keyboard_arrow_up"
                      : "keyboard_arrow_down"
                  }}
                </mat-icon>
              </button>
            </div>
          </mat-expansion-panel-header>
          <div class="grid-multiple margin-top">            
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.allowDiscard"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si el checklist permite descartar el llenado"
              >
                <span fieldTitle class="label field__label"
                  >¿El checklist permite descartar el llenado?</span
                >
              </app-select-field>                
            </div>
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.allowRejection"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si el checklist permite ser rechazado"
              >
                <span fieldTitle class="label field__label"
                  >¿El checklist permite ser rechazado?</span
                >
              </app-select-field>                
            </div>
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.allowManualMode"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si el checklist permite modo manual"
              >
                <span fieldTitle class="label field__label"
                  >¿El checklist permite modo manual?</span
                >
              </app-select-field>                
            </div>
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.allowPartialSaving"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si el checklist permite el guardado parcial"
              >
                <span fieldTitle class="label field__label"
                  >¿El checklist permite guardado parcial?</span
                >
              </app-select-field>                
            </div>
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.allowApprovalByGroup"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si el checklist permite ser aprobado por el grupo"
              >
                <span fieldTitle class="label field__label"
                  >¿El checklist permite ser aprobado por el grupo?</span
                >
              </app-select-field>                
            </div>
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.allowExpiring"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si el checklist permite expiración"
              >
                <span fieldTitle class="label field__label"
                  >¿El checklist expira?</span
                >
              </app-select-field>                
            </div>
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.requiresApproval"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si el checklist requiere aprobación"
              >
                <span fieldTitle class="label field__label"
                  >¿El checklist requiere aprobación?</span
                >
              </app-select-field>                
            </div>            
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.allowReassignment"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si el checklist permite ser reasignado"
              >
                <span fieldTitle class="label field__label"
                  >¿El checklist permite ser reasignado a otro usuario?</span
                >
              </app-select-field>                
            </div>
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.requiresActivation"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si el checklist requiere activación"
              >
                <span fieldTitle class="label field__label"
                  >¿El checklist requiere activación?</span
                >
              </app-select-field>                
            </div>
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.allowRestarting"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si el checklist permite reseteo"
              >
                <span fieldTitle class="label field__label"
                  >¿El checklist permite ser reseteado?</span
                >
              </app-select-field>                
            </div>
            <div class="field-items">
              <app-select-field
                [formField]="checklistTemplateForm.controls.cancelOpenChecklists"
                [list]="genYesNoValues.items"                
                fieldHelp="Especifique si la generación de este checklist cancela los demás que estén abiertos"
              >
                <span fieldTitle class="label field__label"
                  >Al generar este checklist cancelarían los demás no iniciados?</span
                >
              </app-select-field>                
            </div>
          </div>
        </mat-expansion-panel>
        <mat-expansion-panel
          (opened)="panelOpenState[2] = true"
          (closed)="panelOpenState[2] = false"
          hideToggle="true"
          [expanded]="panelOpenState[2]"
        >
          <mat-expansion-panel-header
            [collapsedHeight]="'55px'"
            [ngStyle]="{
              'background-color': panelOpenState[2]
                ? 'var(--z-colors-page-shadow)'
                : 'var(--z-colors-page-card-background-color)'
            }"
          >
            <mat-panel-title>
              <mat-icon class="accordion-icon" svgIcon="treasure_chest"> </mat-icon>
              <label class="accordion-label">MOLDES ASOCIADOS</label>
            </mat-panel-title>
            <div class="icon-button-container">
              <button
                mat-icon-button
                class="icon-button open"
                aria-label="icon-button with menu icon"
              >
                <mat-icon class="icon-button">
                  {{
                    panelOpenState[2]
                      ? "keyboard_arrow_up"
                      : "keyboard_arrow_down"
                  }}
                </mat-icon>
              </button>
            </div>
          </mat-expansion-panel-header>
          <div class="grid-multiple margin-top">            
            <div class="field-items">
              <app-multiple-selection-list
                [bordered]="true"
                [showSelect]="true"                  
                [selectOptions]="moldsOptions"
                [currentSelections]="moldsCurrentSelection"        
                [formField]="checklistTemplateForm.controls.molds"
                [list]="molds.items"
                [totalCount]="molds.totalCount"
                [loading]="molds.loading"                
                [catalog]="SystemTables.MOLDS"      
                placeHolder="Filtrar..."
                [defaultValue]="multipleSearchDefaultValue"            
                (multipleSelectionChanged)="handleMultipleSelectionChanged($event)"
                (getMoreData)="getMoreData($event)"
              >
              <span fieldTitle class="label field__label">Moldes donde se puede aplicar este checklist</span>
              </app-multiple-selection-list>                
            </div>
            <div
              class="field-items"
              style="flex: 0.5;" 
            >
              <fieldset
                class="multiple-selection-list__field-container"
                style="height: calc(100% - 22px);"           
              >
                <span class="label field__label">Estado del molde para apicar este chesklist</span>
                <div
                  class="multiple-selection-list__list-options-container" 
                  style="max-height: 260px;"                 
                >
                  <div
                    *ngIf="loading"
                    class="multiple-selection-list__progress-container"
                  >
                    <mat-progress-spinner
                      mode="indeterminate"
                      color="primary"
                      class="multiple-selection-list__progress"
                      diameter="64"
                    >
                    </mat-progress-spinner>
                  </div>
                  <div          
                    class="multiple-selection-list__list-options-box no-selections"
                    style="height: 250px;"                 
                    *ngIf="states.items.length === 0 && !loading"
                  >
                    <span>No hay elementos a mostrar...</span>
                  </div>
                  <mat-selection-list
                    *ngIf="states?.items.length > 0 || loading"
                    class="multiple-selection-list__list-options-box"    
                    style="height: 250px;"                                 
                    name="multipleSelection"
                    (click)="handleChangeSelection($event)"
                    (keydown)="handleKeyDown($event)"
                    cdkScrollable
                  >
                    <mat-list-option
                      *ngFor="let item of states.items; let i = index"            
                      [value]="item.id"
                      (click)="handleStatesSelectItem(item)"
                      (keydown)="handleKeyDown($event)"
                      [selected]="!!item.selected"
                      checkboxPosition="before"
                      
                      color="primary"
                    >
                      <div class="multiple-selection-list__list-option-container">
                        <div class="multiple-selection-list__list-option">
                          {{ item.friendlyText }}
                        </div>
                      </div>
                    </mat-list-option>
                  </mat-selection-list>
                </div>
                <div
                  class="multiple-selection-list__search-container"        
                >
                  <mat-hint
                    class="auto-complete__hint"
                    align="start"          
                  >
                    <span
                      *ngIf="states?.items.length > 0"
                      class="auto-complete__hint--normal"
                    >
                      Item(s): {{ states.items.length }}
                    </span>
                    <span 
                      *ngIf="states.items.length === 0"
                      class="auto-complete__hint--normal"
                    >
                      No hay items a mostrar...
                    </span>
                  </mat-hint>
                  <mat-hint
                    class="auto-complete__hint"
                    align="end"          
                  >
                    <span class="auto-complete__hint--normal">
                        Seleccionados en la lista: {{ statesSelected }}
                    </span>
                  </mat-hint>
                </div>
              </fieldset>
            </div>
          </div>
        </mat-expansion-panel> 
        <mat-expansion-panel
          (opened)="panelOpenState[3] = true"
          (closed)="panelOpenState[3] = false"
          hideToggle="true"
          [expanded]="panelOpenState[3]"
        >
          <mat-expansion-panel-header
            [collapsedHeight]="'55px'"
            [ngStyle]="{
              'background-color': panelOpenState[3]
                ? 'var(--z-colors-page-shadow)'
                : 'var(--z-colors-page-card-background-color)'
            }"
          >
            <mat-panel-title>
              <mat-icon class="accordion-icon" svgIcon="announcements"> </mat-icon>
              <label class="accordion-label">NOTIFICACIONES</label>
            </mat-panel-title>
            <div class="icon-button-container">
              <button
                mat-icon-button
                class="icon-button open"
                aria-label="icon-button with menu icon"
              >
                <mat-icon class="icon-button">
                  {{
                    panelOpenState[3]
                      ? "keyboard_arrow_up"
                      : "keyboard_arrow_down"
                  }}
                </mat-icon>
              </button>
            </div>
          </mat-expansion-panel-header>
          <mat-expansion-panel            
            (opened)="generalPanelOpenState[0] = true"
            (closed)="generalPanelOpenState[0] = false"
            hideToggle="true"
            [expanded]="generalPanelOpenState[0]"
            style="margin: 5px"
          >
            <mat-expansion-panel-header              
              [collapsedHeight]="'55px'"
              [ngStyle]="{
                'background-color': generalPanelOpenState[0]
                  ? 'var(--z-colors-page-shadow)'
                  : 'var(--z-colors-page-card-background-color)'
              }"
            >
              <mat-panel-title>
                <mat-icon class="accordion-icon" svgIcon="time_cycles"> </mat-icon>    
                <label class="accordion-label-no-counter">ANTICIPACIÓN DEL CHECKLIST</label>
              </mat-panel-title>
              <div class="icon-button-container">
                <button
                  mat-icon-button
                  class="icon-button open"
                  aria-label="icon-button with menu icon"
                >
                  <mat-icon class="icon-button">
                    {{
                      generalPanelOpenState[0]
                        ? "keyboard_arrow_up"
                        : "keyboard_arrow_down"
                    }}
                  </mat-icon>
                </button>
              </div>
            </mat-expansion-panel-header>
            <div class="grid-multiple margin-top">        
              <div class="field-items">
                <app-select-field
                  [formField]="checklistTemplateForm.controls.notifyAnticipation"
                  [list]="genYesNoValues.items"                
                  fieldHelp="Especifique si el checklist se notifica anticipadamente"
                >
                  <span fieldTitle class="label field__label"
                    >¿El checklist se notifica anticipadamente?</span
                  >
                </app-select-field>                
              </div>
              <div class="field-items">
                <fieldset
                  class="multiple-selection-list__field-container"
                  [disabled]="checklistTemplateForm.controls.notifyAnticipation.value !== 'y'"                
                >
                  <span class="label field__label">Modo de notificación</span>
                  <div
                    class="multiple-selection-list__list-options-container"
                    [ngStyle]="{
                      'border-color':
                      checklistTemplateForm.controls.notifyAnticipation.value !== 'y'
                          ? 'var(--z-colors-page-button-disabled-border)'
                          : 'var(--theme-primary-300)'
                    }"
                  >
                    <div
                      *ngIf="loading"
                      class="multiple-selection-list__progress-container"
                    >
                      <mat-progress-spinner
                        mode="indeterminate"
                        color="primary"
                        class="multiple-selection-list__progress"
                        diameter="64"
                      >
                      </mat-progress-spinner>
                    </div>
                    <div          
                      class="multiple-selection-list__list-options-box no-selections"
                      *ngIf="anticipationNotificationMode.items.length === 0 && !loading"
                    >
                      <span>No hay elementos a mostrar...</span>
                    </div>
                    <mat-selection-list
                      *ngIf="anticipationNotificationMode?.items.length > 0 || loading"
                      class="multiple-selection-list__list-options-box"
                      [disabled]="
                        checklistTemplateForm.controls.notifyAnticipation.value !== 'y'
                      "
                      name="multipleSelection"
                      (click)="handleChangeSelection($event)"
                      (keydown)="handleKeyDown($event)"
                      cdkScrollable
                    >
                      <mat-list-option
                        *ngFor="let item of anticipationNotificationMode.items; let i = index"            
                        [value]="item.id"
                        (click)="handleNotifyModesSelectItem('anticipation', checklistTemplateForm.controls.notifyAnticipation, item)"
                        (keydown)="handleKeyDown($event)"
                        [selected]="!!item.selected"
                        checkboxPosition="before"
                        
                        color="primary"
                      >
                        <div class="multiple-selection-list__list-option-container">
                          <div class="multiple-selection-list__list-option">
                            {{ item.friendlyText }}
                          </div>
                        </div>
                      </mat-list-option>
                    </mat-selection-list>
                  </div>
                  <div
                    class="multiple-selection-list__search-container"        
                  >
                    <mat-hint
                      class="auto-complete__hint"
                      align="start"          
                    >
                      <span
                        *ngIf="anticipationNotificationMode?.items.length > 0"
                        class="auto-complete__hint--normal"
                      >
                        Item(s): {{ anticipationNotificationMode.items.length }}
                      </span>
                      <span 
                        *ngIf="anticipationNotificationMode.items.length === 0"
                        class="auto-complete__hint--normal"
                      >
                        No hay items a mostrar...
                      </span>
                    </mat-hint>
                    <mat-hint
                      class="auto-complete__hint"
                      align="end"          
                    >
                      <span class="auto-complete__hint--normal">
                          Seleccionados en la lista: {{ anticipationNotificationModeSelected }}
                      </span>
                    </mat-hint>
                  </div>
                </fieldset>
              </div>
              <div class="field-items">
                <fieldset
                  class="multiple-selection-list__field-container"
                  [disabled]="checklistTemplateForm.controls.notifyAnticipation.value !== 'y'"                
                >
                  <span class="label field__label">Canal de notificación</span>
                  <div
                    class="multiple-selection-list__list-options-container"
                    [ngStyle]="{
                      'border-color':
                      checklistTemplateForm.controls.notifyAnticipation.value !== 'y'
                          ? 'var(--z-colors-page-button-disabled-border)'
                          : 'var(--theme-primary-300)'
                    }"
                  >
                    <div
                      *ngIf="loading"
                      class="multiple-selection-list__progress-container"
                    >
                      <mat-progress-spinner
                        mode="indeterminate"
                        color="primary"
                        class="multiple-selection-list__progress"
                        diameter="64"
                      >
                      </mat-progress-spinner>
                    </div>
                    <div          
                      class="multiple-selection-list__list-options-box no-selections"
                      *ngIf="anticipationChannels.items.length === 0 && !loading"
                    >
                      <span>No hay elementos a mostrar...</span>
                    </div>
                    <mat-selection-list
                      *ngIf="anticipationChannels?.items.length > 0 || loading"
                      class="multiple-selection-list__list-options-box"
                      [disabled]="
                        checklistTemplateForm.controls.notifyAnticipation.value !== 'y'
                      "
                      name="multipleSelection"
                      (click)="handleChangeSelection($event)"
                      (keydown)="handleKeyDown($event)"
                      cdkScrollable
                    >
                      <mat-list-option
                        *ngFor="let item of anticipationChannels.items; let i = index"            
                        [value]="item.id"
                        (click)="handleNotifyChannelsSelectItem('anticipation', checklistTemplateForm.controls.notifyAnticipation, item)"
                        (keydown)="handleKeyDown($event)"
                        [selected]="!!item.selected"
                        checkboxPosition="before"
                        
                        color="primary"
                      >
                        <div class="multiple-selection-list__list-option-container">
                          <div class="multiple-selection-list__list-option">
                            {{ item.friendlyText }}
                          </div>
                        </div>
                      </mat-list-option>
                    </mat-selection-list>
                  </div>
                  <div
                    class="multiple-selection-list__search-container"        
                  >
                    <mat-hint
                      class="auto-complete__hint"
                      align="start"          
                    >
                      <span
                        *ngIf="anticipationChannels?.items.length > 0"
                        class="auto-complete__hint--normal"
                      >
                        Item(s): {{ anticipationChannels.items.length }}
                      </span>
                      <span 
                        *ngIf="anticipationChannels.items.length === 0"
                        class="auto-complete__hint--normal"
                      >
                        No hay items a mostrar...
                      </span>
                    </mat-hint>
                    <mat-hint
                      class="auto-complete__hint"
                      align="end"          
                    >
                      <span class="auto-complete__hint--normal">
                          Seleccionados en la lista: {{ anticipationChannelsSelected }}
                      </span>
                    </mat-hint>
                  </div>
                </fieldset>
              </div>
              <div class="field-items">
                <fieldset
                  class="field__container"
                  style="min-width: 350px; height: calc(100% - 22px);"
                  [ngClass]="{
                    'field__container--error':
                      checklistTemplateForm.controls.anticipationRecipient.touched &&
                      !checklistTemplateForm.controls.anticipationRecipient.valid
                  }"
                  [disabled]="checklistTemplateForm.controls.anticipationRecipient.disabled ||checklistTemplateForm.controls.notifyAnticipation.value !== 'y'"
                >
                  <div class="title-with-id">
                    <span class="label field__label">Recipiente asociado</span>
                    <span class="field__label" *ngIf="checklistTemplateForm.controls.anticipationRecipient?.value?.id">Id: {{ checklistTemplateForm.controls.anticipationRecipient?.value?.id }}</span>
                  </div>
                  <app-auto-complete-field
                    [focused]="focusThisField==='anticipationRecipient'"
                    [formField]="checklistTemplateForm.controls.anticipationRecipient"
                    [list]="recipients.items"
                    [totalCount]="recipients.totalCount"
                    leftHint="Escriba el Nombre del recipiente a buscar"
                    [catalog]="SystemTables.RECIPIENTS"
                    [loading]="recipients.loading"
                    noItemsError="No hay recipientes con este nombre"
                    [showDataState]="true"
                    (optionSelected)="handleOptionSelected($event)"
                    (getMoreData)="getMoreData($event)"
                  >
                  </app-auto-complete-field>
                  <span class="field__help"
                    >Especifique el Recipiente a notificar</span
                  >
                </fieldset>
              </div>
              <div
                class="field-items"
                [ngClass]="{ 
                  'field-items--bordered' : checklistTemplateForm.controls.anticipationMessageBody.enabled,
                  'field-items--bordered-disabled' : checklistTemplateForm.controls.anticipationMessageBody.disabled
                }"
              >
                <mat-icon
                  class="macros-icon"
                  svgIcon="transcode"
                  matTooltip="Este campo soporta macros"
                  matTooltipClass="tooltip-general"
                  matTooltipShowDelay="100"
                >
                </mat-icon>              
                <app-area-field
                  [bordered]="false"
                  [formField]="checklistTemplateForm.controls.anticipationMessageBody"                
                  [fieldMaxLength]="1000"
                  [showRightHint]="true"
                  [showCloseButton]="true"
                  [minRows]="1"
                  [maxRows]="5"
                  fieldHelp="Especifique el mensaje que se enviará"
                >
                  <span fieldTitle class="label field__label"
                    >Notificación a enviar al anticipar el checklist</span
                  >
                </app-area-field>               
              </div> 
              <div
                class="field-items"
                [ngClass]="{ 
                  'field-items--bordered' : checklistTemplateForm.controls.anticipationMessageSubject.enabled,
                  'field-items--bordered-disabled' : checklistTemplateForm.controls.anticipationMessageSubject.disabled
                }"
              >
                <mat-icon
                  class="macros-icon"
                  svgIcon="transcode"
                  matTooltip="Este campo soporta macros"
                  matTooltipClass="tooltip-general"
                  matTooltipShowDelay="100"
                >
                </mat-icon>              
                <app-area-field
                  [bordered]="false"
                  [formField]="checklistTemplateForm.controls.anticipationMessageSubject"
                  [fieldMaxLength]="200"
                  [showRightHint]="true"
                  [showCloseButton]="true"
                  [minRows]="1"
                  [maxRows]="5"
                  fieldHelp="Especifique el título de la notificación que se enviará por correo"
                >
                  <span fieldTitle class="label field__label"
                    >Título del mensaje a enviar (sólo para envío de correos)</span
                  >
                </app-area-field>               
              </div>  
              <div class="field-items">
                <app-input-field
                  [bordered]="true"
                  [formField]="checklistTemplateForm.controls.anticipationSeconds"
                  rightHint="Campo opcional"
                  fieldInputType="number"
                  currentErrorIcon="warn_line"
                  [showCloseButton]="true"
                  [showRightHint]="true"
                  leftHint="Expresado en segundos"
                  fieldHelp="Indique el tiempo de anticipación"
                  [rightSuffix]="_sharedService.getHours(checklistTemplateForm.controls.anticipationSeconds.value)"
                >
                  <span fieldTitle class="label field__label"
                    >Tiempo de anticipación</span
                  >
                </app-input-field>
              </div>                   
            </div>
          </mat-expansion-panel>
          <mat-expansion-panel            
            (opened)="generalPanelOpenState[1] = true"
            (closed)="generalPanelOpenState[1] = false"
            hideToggle="true"
            [expanded]="generalPanelOpenState[1]"
            style="margin: 5px"
          >
            <mat-expansion-panel-header              
              [collapsedHeight]="'55px'"
              [ngStyle]="{
                'background-color': generalPanelOpenState[1]
                  ? 'var(--z-colors-page-shadow)'
                  : 'var(--z-colors-page-card-background-color)'
              }"
            >
              <mat-panel-title>
                <mat-icon class="accordion-icon" svgIcon="update"> </mat-icon>
                <label class="accordion-label-no-counter">GENERACIÓN DEL CHECKLIST</label>
              </mat-panel-title>
              <div class="icon-button-container">
                <button
                  mat-icon-button
                  class="icon-button open"
                  aria-label="icon-button with menu icon"
                >
                  <mat-icon class="icon-button">
                    {{
                      generalPanelOpenState[1]
                        ? "keyboard_arrow_up"
                        : "keyboard_arrow_down"
                    }}
                  </mat-icon>
                </button>
              </div>
            </mat-expansion-panel-header>
            <div class="grid-multiple margin-top">        
              <div class="field-items">
                <app-select-field
                  [formField]="checklistTemplateForm.controls.notifyGeneration"
                  [list]="genYesNoValues.items"                
                  fieldHelp="Especifique si el checklist notifica la generación"
                >
                  <span fieldTitle class="label field__label"
                    >¿El checklist se notifica al generarse?</span
                  >
                </app-select-field>                
              </div>
              <div class="field-items">
                <fieldset
                  class="multiple-selection-list__field-container"
                  [disabled]="checklistTemplateForm.controls.notifyGeneration.value !== 'y'"                
                >
                  <span class="label field__label">Modo de notificación</span>
                  <div
                    class="multiple-selection-list__list-options-container"
                    [ngStyle]="{
                      'border-color':
                      checklistTemplateForm.controls.notifyGeneration.value !== 'y'
                          ? 'var(--z-colors-page-button-disabled-border)'
                          : 'var(--theme-primary-300)'
                    }"
                  >
                    <div
                      *ngIf="loading"
                      class="multiple-selection-list__progress-container"
                    >
                      <mat-progress-spinner
                        mode="indeterminate"
                        color="primary"
                        class="multiple-selection-list__progress"
                        diameter="64"
                      >
                      </mat-progress-spinner>
                    </div>
                    <div          
                      class="multiple-selection-list__list-options-box no-selections"
                      *ngIf="generationNotificationMode.items.length === 0 && !loading"
                    >
                      <span>No hay elementos a mostrar...</span>
                    </div>
                    <mat-selection-list
                      *ngIf="generationNotificationMode?.items.length > 0 || loading"
                      class="multiple-selection-list__list-options-box"
                      [disabled]="
                        checklistTemplateForm.controls.notifyGeneration.value !== 'y'
                      "
                      name="multipleSelection"
                      (click)="handleChangeSelection($event)"
                      (keydown)="handleKeyDown($event)"
                      cdkScrollable
                    >
                      <mat-list-option
                        *ngFor="let item of generationNotificationMode.items; let i = index"            
                        [value]="item.id"
                        (click)="handleNotifyModesSelectItem('generation', checklistTemplateForm.controls.notifyGeneration, item)"
                        (keydown)="handleKeyDown($event)"
                        [selected]="!!item.selected"
                        checkboxPosition="before"
                        
                        color="primary"
                      >
                        <div class="multiple-selection-list__list-option-container">
                          <div class="multiple-selection-list__list-option">
                            {{ item.friendlyText }}
                          </div>
                        </div>
                      </mat-list-option>
                    </mat-selection-list>
                  </div>
                  <div
                    class="multiple-selection-list__search-container"        
                  >
                    <mat-hint
                      class="auto-complete__hint"
                      align="start"          
                    >
                      <span
                        *ngIf="generationNotificationMode?.items.length > 0"
                        class="auto-complete__hint--normal"
                      >
                        Item(s): {{ generationNotificationMode.items.length }}
                      </span>
                      <span 
                        *ngIf="generationNotificationMode.items.length === 0"
                        class="auto-complete__hint--normal"
                      >
                        No hay items a mostrar...
                      </span>
                    </mat-hint>
                    <mat-hint
                      class="auto-complete__hint"
                      align="end"          
                    >
                      <span class="auto-complete__hint--normal">
                          Seleccionados en la lista: {{ generationNotificationModeSelected }}
                      </span>
                    </mat-hint>
                  </div>
                </fieldset>
              </div>
              <div class="field-items">
                <fieldset
                  class="multiple-selection-list__field-container"
                  [disabled]="checklistTemplateForm.controls.notifyGeneration.value !== 'y'"                
                >
                  <span class="label field__label">Canal de notificación</span>
                  <div
                    class="multiple-selection-list__list-options-container"
                    [ngStyle]="{
                      'border-color':
                      checklistTemplateForm.controls.notifyGeneration.value !== 'y'
                          ? 'var(--z-colors-page-button-disabled-border)'
                          : 'var(--theme-primary-300)'
                    }"
                  >
                    <div
                      *ngIf="loading"
                      class="multiple-selection-list__progress-container"
                    >
                      <mat-progress-spinner
                        mode="indeterminate"
                        color="primary"
                        class="multiple-selection-list__progress"
                        diameter="64"
                      >
                      </mat-progress-spinner>
                    </div>
                    <div          
                      class="multiple-selection-list__list-options-box no-selections"
                      *ngIf="generationChannels.items.length === 0 && !loading"
                    >
                      <span>No hay elementos a mostrar...</span>
                    </div>
                    <mat-selection-list
                      *ngIf="generationChannels?.items.length > 0 || loading"
                      class="multiple-selection-list__list-options-box"
                      [disabled]="
                        checklistTemplateForm.controls.notifyGeneration.value !== 'y'
                      "
                      name="multipleSelection"
                      (click)="handleChangeSelection($event)"
                      (keydown)="handleKeyDown($event)"
                      cdkScrollable
                    >
                      <mat-list-option
                        *ngFor="let item of generationChannels.items; let i = index"            
                        [value]="item.id"
                        (click)="handleNotifyChannelsSelectItem('generation', checklistTemplateForm.controls.notifyGeneration, item)"
                        (keydown)="handleKeyDown($event)"
                        [selected]="!!item.selected"
                        checkboxPosition="before"
                        
                        color="primary"
                      >
                        <div class="multiple-selection-list__list-option-container">
                          <div class="multiple-selection-list__list-option">
                            {{ item.friendlyText }}
                          </div>
                        </div>
                      </mat-list-option>
                    </mat-selection-list>
                  </div>
                  <div
                    class="multiple-selection-list__search-container"        
                  >
                    <mat-hint
                      class="auto-complete__hint"
                      align="start"          
                    >
                      <span
                        *ngIf="generationChannels?.items.length > 0"
                        class="auto-complete__hint--normal"
                      >
                        Item(s): {{ generationChannels.items.length }}
                      </span>
                      <span 
                        *ngIf="generationChannels.items.length === 0"
                        class="auto-complete__hint--normal"
                      >
                        No hay items a mostrar...
                      </span>
                    </mat-hint>
                    <mat-hint
                      class="auto-complete__hint"
                      align="end"          
                    >
                      <span class="auto-complete__hint--normal">
                          Seleccionados en la lista: {{ generationChannelsSelected }}
                      </span>
                    </mat-hint>
                  </div>
                </fieldset>
              </div>
              <div class="field-items">
                <fieldset
                  class="field__container"
                  style="min-width: 350px; height: calc(100% - 22px);"
                  [ngClass]="{
                    'field__container--error':
                      checklistTemplateForm.controls.generationRecipient.touched &&
                      !checklistTemplateForm.controls.generationRecipient.valid
                  }"
                  [disabled]="checklistTemplateForm.controls.generationRecipient.disabled ||checklistTemplateForm.controls.notifyGeneration.value !== 'y'"
                >
                  <div class="title-with-id">
                    <span class="label field__label">Recipiente asociado</span>
                    <span class="field__label" *ngIf="checklistTemplateForm.controls.generationRecipient?.value?.id">Id: {{ checklistTemplateForm.controls.generationRecipient?.value?.id }}</span>
                  </div>
                  <app-auto-complete-field
                    [focused]="focusThisField==='generationRecipient'"
                    [formField]="checklistTemplateForm.controls.generationRecipient"
                    [list]="recipients.items"
                    [totalCount]="recipients.totalCount"
                    leftHint="Escriba el Nombre del recipiente a buscar"
                    [catalog]="SystemTables.RECIPIENTS"
                    [loading]="recipients.loading"
                    noItemsError="No hay recipientes con este nombre"
                    [showDataState]="true"
                    (optionSelected)="handleOptionSelected($event)"
                    (getMoreData)="getMoreData($event)"
                  >
                  </app-auto-complete-field>
                  <span class="field__help"
                    >Especifique el Recipiente a notificar</span
                  >
                </fieldset>
              </div>
              <div
                class="field-items"
                [ngClass]="{ 
                  'field-items--bordered' : checklistTemplateForm.controls.generationMessageBody.enabled,
                  'field-items--bordered-disabled' : checklistTemplateForm.controls.generationMessageBody.disabled
                }"
              >
                <mat-icon
                  class="macros-icon"
                  svgIcon="transcode"
                  matTooltip="Este campo soporta macros"
                  matTooltipClass="tooltip-general"
                  matTooltipShowDelay="100"
                >
                </mat-icon>              
                <app-area-field
                  [bordered]="false"
                  [formField]="checklistTemplateForm.controls.generationMessageBody"                
                  [fieldMaxLength]="1000"
                  [showRightHint]="true"
                  [showCloseButton]="true"
                  [minRows]="1"
                  [maxRows]="5"
                  fieldHelp="Especifique el mensaje que se enviará"
                >
                  <span fieldTitle class="label field__label"
                    >Notificación a enviar al generar el checklist</span
                  >
                </app-area-field>               
              </div> 
              <div
                class="field-items"
                [ngClass]="{ 
                  'field-items--bordered' : checklistTemplateForm.controls.generationMessageSubject.enabled,
                  'field-items--bordered-disabled' : checklistTemplateForm.controls.generationMessageSubject.disabled
                }"
              >
                <mat-icon
                  class="macros-icon"
                  svgIcon="transcode"
                  matTooltip="Este campo soporta macros"
                  matTooltipClass="tooltip-general"
                  matTooltipShowDelay="100"
                >
                </mat-icon>              
                <app-area-field
                  [bordered]="false"
                  [formField]="checklistTemplateForm.controls.generationMessageSubject"
                  [fieldMaxLength]="200"
                  [showRightHint]="true"
                  [showCloseButton]="true"
                  [minRows]="1"
                  [maxRows]="5"
                  fieldHelp="Especifique el título de la notificación que se enviará por correo"
                >
                  <span fieldTitle class="label field__label"
                    >Título del mensaje a enviar en la generación (sólo para envío de correos)</span
                  >
                </app-area-field>               
              </div> 
            </div>
          </mat-expansion-panel>
          <mat-expansion-panel            
            (opened)="generalPanelOpenState[2] = true"
            (closed)="generalPanelOpenState[2] = false"
            hideToggle="true"
            [expanded]="generalPanelOpenState[2]"
            style="margin: 5px"
          >
            <mat-expansion-panel-header              
              [collapsedHeight]="'55px'"
              [ngStyle]="{
                'background-color': generalPanelOpenState[2]
                  ? 'var(--z-colors-page-shadow)'
                  : 'var(--z-colors-page-card-background-color)'
              }"
            >
              <mat-panel-title>
                <mat-icon class="accordion-icon" svgIcon="accept_document"> </mat-icon>
                <label class="accordion-label-no-counter">APROBACIÓN DEL CHECKLIST</label>
              </mat-panel-title>
              <div class="icon-button-container">
                <button
                  mat-icon-button
                  class="icon-button open"
                  aria-label="icon-button with menu icon"
                >
                  <mat-icon class="icon-button">
                    {{
                      generalPanelOpenState[2]
                        ? "keyboard_arrow_up"
                        : "keyboard_arrow_down"
                    }}
                  </mat-icon>
                </button>
              </div>
            </mat-expansion-panel-header>
            <div class="grid-multiple margin-top">        
              <div class="field-items">
                <app-select-field
                  [formField]="checklistTemplateForm.controls.notifyApproval"
                  [list]="genYesNoValues.items"                
                  fieldHelp="Especifique si el checklist se notifica la generación"
                >
                  <span fieldTitle class="label field__label"
                    >¿El checklist notifica la aprobación?</span
                  >
                </app-select-field>                
              </div>
              <div class="field-items">
                <fieldset
                  class="multiple-selection-list__field-container"
                  [disabled]="checklistTemplateForm.controls.notifyApproval.value !== 'y'"                
                >
                  <span class="label field__label">Modo de notificación</span>
                  <div
                    class="multiple-selection-list__list-options-container"
                    [ngStyle]="{
                      'border-color':
                      checklistTemplateForm.controls.notifyApproval.value !== 'y'
                          ? 'var(--z-colors-page-button-disabled-border)'
                          : 'var(--theme-primary-300)'
                    }"
                  >
                    <div
                      *ngIf="loading"
                      class="multiple-selection-list__progress-container"
                    >
                      <mat-progress-spinner
                        mode="indeterminate"
                        color="primary"
                        class="multiple-selection-list__progress"
                        diameter="64"
                      >
                      </mat-progress-spinner>
                    </div>
                    <div          
                      class="multiple-selection-list__list-options-box no-selections"
                      *ngIf="approvalNotificationMode.items.length === 0 && !loading"
                    >
                      <span>No hay elementos a mostrar...</span>
                    </div>
                    <mat-selection-list
                      *ngIf="approvalNotificationMode?.items.length > 0 || loading"
                      class="multiple-selection-list__list-options-box"
                      [disabled]="
                        checklistTemplateForm.controls.notifyApproval.value !== 'y'
                      "
                      name="multipleSelection"
                      (click)="handleChangeSelection($event)"
                      (keydown)="handleKeyDown($event)"
                      cdkScrollable
                    >
                      <mat-list-option
                        *ngFor="let item of approvalNotificationMode.items; let i = index"            
                        [value]="item.id"
                        (click)="handleNotifyModesSelectItem('generation', checklistTemplateForm.controls.notifyApproval, item)"
                        (keydown)="handleKeyDown($event)"
                        [selected]="!!item.selected"
                        checkboxPosition="before"
                        
                        color="primary"
                      >
                        <div class="multiple-selection-list__list-option-container">
                          <div class="multiple-selection-list__list-option">
                            {{ item.friendlyText }}
                          </div>
                        </div>
                      </mat-list-option>
                    </mat-selection-list>
                  </div>
                  <div
                    class="multiple-selection-list__search-container"        
                  >
                    <mat-hint
                      class="auto-complete__hint"
                      align="start"          
                    >
                      <span
                        *ngIf="approvalNotificationMode?.items.length > 0"
                        class="auto-complete__hint--normal"
                      >
                        Item(s): {{ approvalNotificationMode.items.length }}
                      </span>
                      <span 
                        *ngIf="approvalNotificationMode.items.length === 0"
                        class="auto-complete__hint--normal"
                      >
                        No hay items a mostrar...
                      </span>
                    </mat-hint>
                    <mat-hint
                      class="auto-complete__hint"
                      align="end"          
                    >
                      <span class="auto-complete__hint--normal">
                          Seleccionados en la lista: {{ approvalNotificationModeSelected }}
                      </span>
                    </mat-hint>
                  </div>
                </fieldset>
              </div>
              <div class="field-items">
                <fieldset
                  class="multiple-selection-list__field-container"
                  [disabled]="checklistTemplateForm.controls.notifyApproval.value !== 'y'"                
                >
                  <span class="label field__label">Canal de notificación</span>
                  <div
                    class="multiple-selection-list__list-options-container"
                    [ngStyle]="{
                      'border-color':
                      checklistTemplateForm.controls.notifyApproval.value !== 'y'
                          ? 'var(--z-colors-page-button-disabled-border)'
                          : 'var(--theme-primary-300)'
                    }"
                  >
                    <div
                      *ngIf="loading"
                      class="multiple-selection-list__progress-container"
                    >
                      <mat-progress-spinner
                        mode="indeterminate"
                        color="primary"
                        class="multiple-selection-list__progress"
                        diameter="64"
                      >
                      </mat-progress-spinner>
                    </div>
                    <div          
                      class="multiple-selection-list__list-options-box no-selections"
                      *ngIf="approvalRequestChannels.items.length === 0 && !loading"
                    >
                      <span>No hay elementos a mostrar...</span>
                    </div>
                    <mat-selection-list
                      *ngIf="approvalRequestChannels?.items.length > 0 || loading"
                      class="multiple-selection-list__list-options-box"
                      [disabled]="
                        checklistTemplateForm.controls.notifyApproval.value !== 'y'
                      "
                      name="multipleSelection"
                      (click)="handleChangeSelection($event)"
                      (keydown)="handleKeyDown($event)"
                      cdkScrollable
                    >
                      <mat-list-option
                        *ngFor="let item of approvalRequestChannels.items; let i = index"            
                        [value]="item.id"
                        (click)="handleNotifyChannelsSelectItem('generation', checklistTemplateForm.controls.notifyApproval, item)"
                        (keydown)="handleKeyDown($event)"
                        [selected]="!!item.selected"
                        checkboxPosition="before"
                        
                        color="primary"
                      >
                        <div class="multiple-selection-list__list-option-container">
                          <div class="multiple-selection-list__list-option">
                            {{ item.friendlyText }}
                          </div>
                        </div>
                      </mat-list-option>
                    </mat-selection-list>
                  </div>
                  <div
                    class="multiple-selection-list__search-container"        
                  >
                    <mat-hint
                      class="auto-complete__hint"
                      align="start"          
                    >
                      <span
                        *ngIf="approvalRequestChannels?.items.length > 0"
                        class="auto-complete__hint--normal"
                      >
                        Item(s): {{ approvalRequestChannels.items.length }}
                      </span>
                      <span 
                        *ngIf="approvalRequestChannels.items.length === 0"
                        class="auto-complete__hint--normal"
                      >
                        No hay items a mostrar...
                      </span>
                    </mat-hint>
                    <mat-hint
                      class="auto-complete__hint"
                      align="end"          
                    >
                      <span class="auto-complete__hint--normal">
                          Seleccionados en la lista: {{ approvalRequestChannelsSelected }}
                      </span>
                    </mat-hint>
                  </div>
                </fieldset>
              </div>
              <div class="field-items">
                <fieldset
                  class="field__container"
                  style="min-width: 350px; height: calc(100% - 22px);"
                  [ngClass]="{
                    'field__container--error':
                      checklistTemplateForm.controls.approvalRecipient.touched &&
                      !checklistTemplateForm.controls.approvalRecipient.valid
                  }"
                  [disabled]="checklistTemplateForm.controls.approvalRecipient.disabled ||checklistTemplateForm.controls.notifyApproval.value !== 'y'"
                >
                  <div class="title-with-id">
                    <span class="label field__label">Recipiente asociado</span>
                    <span class="field__label" *ngIf="checklistTemplateForm.controls.approvalRecipient?.value?.id">Id: {{ checklistTemplateForm.controls.approvalRecipient?.value?.id }}</span>
                  </div>
                  <app-auto-complete-field
                    [focused]="focusThisField==='approvalRecipient'"
                    [formField]="checklistTemplateForm.controls.approvalRecipient"
                    [list]="recipients.items"
                    [totalCount]="recipients.totalCount"
                    leftHint="Escriba el Nombre del recipiente a buscar"
                    [catalog]="SystemTables.RECIPIENTS"
                    [loading]="recipients.loading"
                    noItemsError="No hay recipientes con este nombre"
                    [showDataState]="true"
                    (optionSelected)="handleOptionSelected($event)"
                    (getMoreData)="getMoreData($event)"
                  >
                  </app-auto-complete-field>
                  <span class="field__help"
                    >Especifique el Recipiente a notificar</span
                  >
                </fieldset>
              </div>
              <div
                class="field-items"
                [ngClass]="{ 
                  'field-items--bordered' : checklistTemplateForm.controls.approvalRequestMessageBody.enabled,
                  'field-items--bordered-disabled' : checklistTemplateForm.controls.approvalRequestMessageBody.disabled
                }"
              >
                <mat-icon
                  class="macros-icon"
                  svgIcon="transcode"
                  matTooltip="Este campo soporta macros"
                  matTooltipClass="tooltip-general"
                  matTooltipShowDelay="100"
                >
                </mat-icon>              
                <app-area-field
                  [bordered]="false"
                  [formField]="checklistTemplateForm.controls.approvalRequestMessageBody"                
                  [fieldMaxLength]="1000"
                  [showRightHint]="true"
                  [showCloseButton]="true"
                  [minRows]="1"
                  [maxRows]="5"
                  fieldHelp="Especifique el mensaje que se enviará"
                >
                  <span fieldTitle class="label field__label"
                    >Notificación a enviar al solicitar la aprobación del checklist</span
                  >
                </app-area-field>               
              </div> 
              <div
                class="field-items"
                [ngClass]="{ 
                  'field-items--bordered' : checklistTemplateForm.controls.approvalRequestMessageSubject.enabled,
                  'field-items--bordered-disabled' : checklistTemplateForm.controls.approvalRequestMessageSubject.disabled
                }"
              >
                <mat-icon
                  class="macros-icon"
                  svgIcon="transcode"
                  matTooltip="Este campo soporta macros"
                  matTooltipClass="tooltip-general"
                  matTooltipShowDelay="100"
                >
                </mat-icon>              
                <app-area-field
                  [bordered]="false"
                  [formField]="checklistTemplateForm.controls.approvalRequestMessageSubject"
                  [fieldMaxLength]="200"
                  [showRightHint]="true"
                  [showCloseButton]="true"
                  [minRows]="1"
                  [maxRows]="5"
                  fieldHelp="Especifique el título de la notificación que se enviará por correo"
                >
                  <span fieldTitle class="label field__label"
                    >Título del mensaje a enviar al solicitar la aprobación del checklist (sólo para envío de correos)</span
                  >
                </app-area-field>               
              </div> 
            </div>
          </mat-expansion-panel>
          <mat-expansion-panel            
            (opened)="generalPanelOpenState[3] = true"
            (closed)="generalPanelOpenState[3] = false"
            hideToggle="true"
            [expanded]="generalPanelOpenState[3]"
            style="margin: 5px"
          >
            <mat-expansion-panel-header              
              [collapsedHeight]="'55px'"
              [ngStyle]="{
                'background-color': generalPanelOpenState[3]
                  ? 'var(--z-colors-page-shadow)'
                  : 'var(--z-colors-page-card-background-color)'
              }"
            >
              <mat-panel-title>            
                <mat-icon class="accordion-icon" svgIcon="delivery_time_1"> </mat-icon>    
                <label class="accordion-label-no-counter">EXPIRACIÓN DEL CHECKLIST</label>
              </mat-panel-title>
              <div class="icon-button-container">
                <button
                  mat-icon-button
                  class="icon-button open"
                  aria-label="icon-button with menu icon"
                >
                  <mat-icon class="icon-button">
                    {{
                      generalPanelOpenState[3]
                        ? "keyboard_arrow_up"
                        : "keyboard_arrow_down"
                    }}
                  </mat-icon>
                </button>
              </div>
            </mat-expansion-panel-header>
            <div class="grid-multiple margin-top">        
              <div class="field-items">
                <app-select-field
                  [formField]="checklistTemplateForm.controls.notifyExpiring"
                  [list]="genYesNoValues.items"                
                  fieldHelp="Especifique si el checklist notifica la expiración"
                >
                  <span fieldTitle class="label field__label"
                    >¿El checklist notifica la expiración?</span
                  >
                </app-select-field>                
              </div>
              <div class="field-items">
                <fieldset
                  class="multiple-selection-list__field-container"
                  [disabled]="checklistTemplateForm.controls.notifyExpiring.value !== 'y'"                
                >
                  <span class="label field__label">Modo de notificación</span>
                  <div
                    class="multiple-selection-list__list-options-container"
                    [ngStyle]="{
                      'border-color':
                      checklistTemplateForm.controls.notifyExpiring.value !== 'y'
                          ? 'var(--z-colors-page-button-disabled-border)'
                          : 'var(--theme-primary-300)'
                    }"
                  >
                    <div
                      *ngIf="loading"
                      class="multiple-selection-list__progress-container"
                    >
                      <mat-progress-spinner
                        mode="indeterminate"
                        color="primary"
                        class="multiple-selection-list__progress"
                        diameter="64"
                      >
                      </mat-progress-spinner>
                    </div>
                    <div          
                      class="multiple-selection-list__list-options-box no-selections"
                      *ngIf="expiringNotificationMode.items.length === 0 && !loading"
                    >
                      <span>No hay elementos a mostrar...</span>
                    </div>
                    <mat-selection-list
                      *ngIf="expiringNotificationMode.items.length > 0 || loading"
                      class="multiple-selection-list__list-options-box"
                      [disabled]="
                        checklistTemplateForm.controls.notifyExpiring.value !== 'y'
                      "
                      name="multipleSelection"
                      (click)="handleChangeSelection($event)"
                      (keydown)="handleKeyDown($event)"
                      cdkScrollable
                    >
                      <mat-list-option
                        *ngFor="let item of expiringNotificationMode.items; let i = index"            
                        [value]="item.id"
                        (click)="handleNotifyModesSelectItem('expiring', checklistTemplateForm.controls.notifyExpiring, item)"
                        (keydown)="handleKeyDown($event)"
                        [selected]="!!item.selected"
                        checkboxPosition="before"
                        
                        color="primary"
                      >
                        <div class="multiple-selection-list__list-option-container">
                          <div class="multiple-selection-list__list-option">
                            {{ item.friendlyText }}
                          </div>
                        </div>
                      </mat-list-option>
                    </mat-selection-list>
                  </div>
                  <div
                    class="multiple-selection-list__search-container"        
                  >
                    <mat-hint
                      class="auto-complete__hint"
                      align="start"          
                    >
                      <span
                        *ngIf="expiringNotificationMode?.items.length > 0"
                        class="auto-complete__hint--normal"
                      >
                        Item(s): {{ expiringNotificationMode.items.length }}
                      </span>
                      <span 
                        *ngIf="expiringNotificationMode.items.length === 0"
                        class="auto-complete__hint--normal"
                      >
                        No hay items a mostrar...
                      </span>
                    </mat-hint>
                    <mat-hint
                      class="auto-complete__hint"
                      align="end"          
                    >
                      <span class="auto-complete__hint--normal">
                          Seleccionados en la lista: {{ expiringNotificationModeSelected }}
                      </span>
                    </mat-hint>
                  </div>
                </fieldset>
              </div>
              <div class="field-items">
                <fieldset
                  class="multiple-selection-list__field-container"
                  [disabled]="checklistTemplateForm.controls.notifyExpiring.value !== 'y'"                
                >
                  <span class="label field__label">Canal de notificación</span>
                  <div
                    class="multiple-selection-list__list-options-container"
                    [ngStyle]="{
                      'border-color':
                      checklistTemplateForm.controls.notifyExpiring.value !== 'y'
                          ? 'var(--z-colors-page-button-disabled-border)'
                          : 'var(--theme-primary-300)'
                    }"
                  >
                    <div
                      *ngIf="loading"
                      class="multiple-selection-list__progress-container"
                    >
                      <mat-progress-spinner
                        mode="indeterminate"
                        color="primary"
                        class="multiple-selection-list__progress"
                        diameter="64"
                      >
                      </mat-progress-spinner>
                    </div>
                    <div          
                      class="multiple-selection-list__list-options-box no-selections"
                      *ngIf="expiringChannels.items.length === 0 && !loading"
                    >
                      <span>No hay elementos a mostrar...</span>
                    </div>
                    <mat-selection-list
                      *ngIf="expiringChannels?.items.length > 0 || loading"
                      class="multiple-selection-list__list-options-box"
                      [disabled]="
                        checklistTemplateForm.controls.notifyExpiring.value !== 'y'
                      "
                      name="multipleSelection"
                      (click)="handleChangeSelection($event)"
                      (keydown)="handleKeyDown($event)"
                      cdkScrollable
                    >
                      <mat-list-option
                        *ngFor="let item of expiringChannels.items; let i = index"            
                        [value]="item.id"
                        (click)="handleNotifyChannelsSelectItem('expiring', checklistTemplateForm.controls.notifyExpiring, item)"
                        (keydown)="handleKeyDown($event)"
                        [selected]="!!item.selected"
                        checkboxPosition="before"
                        
                        color="primary"
                      >
                        <div class="multiple-selection-list__list-option-container">
                          <div class="multiple-selection-list__list-option">
                            {{ item.friendlyText }}
                          </div>
                        </div>
                      </mat-list-option>
                    </mat-selection-list>
                  </div>
                  <div
                    class="multiple-selection-list__search-container"        
                  >
                    <mat-hint
                      class="auto-complete__hint"
                      align="start"          
                    >
                      <span
                        *ngIf="expiringChannels?.items.length > 0"
                        class="auto-complete__hint--normal"
                      >
                        Item(s): {{ expiringChannels.items.length }}
                      </span>
                      <span 
                        *ngIf="expiringChannels.items.length === 0"
                        class="auto-complete__hint--normal"
                      >
                        No hay items a mostrar...
                      </span>
                    </mat-hint>
                    <mat-hint
                      class="auto-complete__hint"
                      align="end"          
                    >
                      <span class="auto-complete__hint--normal">
                          Seleccionados en la lista: {{ expiringChannelsSelected }}
                      </span>
                    </mat-hint>
                  </div>
                </fieldset>
              </div>
              <div class="field-items">
                <fieldset
                  class="field__container"
                  style="min-width: 350px; height: calc(100% - 22px);"
                  [ngClass]="{
                    'field__container--error':
                      checklistTemplateForm.controls.expiringRecipient.touched &&
                      !checklistTemplateForm.controls.expiringRecipient.valid
                  }"
                  [disabled]="checklistTemplateForm.controls.expiringRecipient.disabled ||checklistTemplateForm.controls.notifyExpiring.value !== 'y'"
                >
                  <div class="title-with-id">
                    <span class="label field__label">Recipiente asociado</span>
                    <span class="field__label" *ngIf="checklistTemplateForm.controls.expiringRecipient?.value?.id">Id: {{ checklistTemplateForm.controls.expiringRecipient?.value?.id }}</span>
                  </div>
                  <app-auto-complete-field
                    [focused]="focusThisField==='expiringRecipient'"
                    [formField]="checklistTemplateForm.controls.expiringRecipient"
                    [list]="recipients.items"
                    [totalCount]="recipients.totalCount"
                    leftHint="Escriba el Nombre del recipiente a buscar"
                    [catalog]="SystemTables.RECIPIENTS"
                    [loading]="recipients.loading"
                    noItemsError="No hay recipientes con este nombre"
                    [showDataState]="true"
                    (optionSelected)="handleOptionSelected($event)"
                    (getMoreData)="getMoreData($event)"
                  >
                  </app-auto-complete-field>
                  <span class="field__help"
                    >Especifique el Recipiente a notificar</span
                  >
                </fieldset>
              </div> 
              <div
                class="field-items"
                [ngClass]="{ 
                  'field-items--bordered' : checklistTemplateForm.controls.expiringMessageBody.enabled,
                  'field-items--bordered-disabled' : checklistTemplateForm.controls.expiringMessageBody.disabled
                }"
              >
                <mat-icon
                  class="macros-icon"
                  svgIcon="transcode"
                  matTooltip="Este campo soporta macros"
                  matTooltipClass="tooltip-general"
                  matTooltipShowDelay="100"
                >
                </mat-icon>              
                <app-area-field
                  [bordered]="false"
                  [formField]="checklistTemplateForm.controls.expiringMessageBody"                
                  [fieldMaxLength]="1000"
                  [showRightHint]="true"
                  [showCloseButton]="true"
                  [minRows]="1"
                  [maxRows]="5"
                  fieldHelp="Especifique el mensaje que se enviará"
                >
                  <span fieldTitle class="label field__label"
                    >Notificación a enviar cuando expire el checklist</span
                  >
                </app-area-field>               
              </div> 
              <div
                class="field-items"
                [ngClass]="{ 
                  'field-items--bordered' : checklistTemplateForm.controls.expiringMessageSubject.enabled,
                  'field-items--bordered-disabled' : checklistTemplateForm.controls.expiringMessageSubject.disabled
                }"
              >
                <mat-icon
                  class="macros-icon"
                  svgIcon="transcode"
                  matTooltip="Este campo soporta macros"
                  matTooltipClass="tooltip-general"
                  matTooltipShowDelay="100"
                >
                </mat-icon>              
                <app-area-field
                  [bordered]="false"
                  [formField]="checklistTemplateForm.controls.expiringMessageSubject"
                  [fieldMaxLength]="200"
                  [showRightHint]="true"
                  [showCloseButton]="true"
                  [minRows]="1"
                  [maxRows]="5"
                  fieldHelp="Especifique el título de la notificación que se enviará por correo"
                >
                  <span fieldTitle class="label field__label"
                    >Título del mensaje a enviar (sólo para envío de correos)</span
                  >
                </app-area-field>               
              </div> 
            </div>
          </mat-expansion-panel>
          <mat-expansion-panel            
            (opened)="generalPanelOpenState[4] = true"
            (closed)="generalPanelOpenState[4] = false"
            hideToggle="true"
            [expanded]="generalPanelOpenState[4]"
            style="margin: 5px"
          >
            <mat-expansion-panel-header              
              [collapsedHeight]="'55px'"
              [ngStyle]="{
                'background-color': generalPanelOpenState[4]
                  ? 'var(--z-colors-page-shadow)'
                  : 'var(--z-colors-page-card-background-color)'
              }"
            >
              <mat-panel-title>            
                <mat-icon class="accordion-icon" svgIcon="warn_fill"> </mat-icon>    
                <label class="accordion-label-no-counter">ALARMADO DEL CHECKLIST</label>
              </mat-panel-title>
              <div class="icon-button-container">
                <button
                  mat-icon-button
                  class="icon-button open"
                  aria-label="icon-button with menu icon"
                >
                  <mat-icon class="icon-button">
                    {{
                      generalPanelOpenState[4]
                        ? "keyboard_arrow_up"
                        : "keyboard_arrow_down"
                    }}
                  </mat-icon>
                </button>
              </div>
            </mat-expansion-panel-header>
            <div class="grid-multiple margin-top">        
              <div class="field-items">
                <app-select-field
                  [formField]="checklistTemplateForm.controls.notifyAlarm"
                  [list]="genYesNoValues.items"                
                  fieldHelp="Especifique si el checklist notifica su alarmado"
                >
                  <span fieldTitle class="label field__label"
                    >¿El checklist notificará cuiando se alarme?</span
                  >
                </app-select-field>                
              </div>
              <div class="field-items">
                <fieldset
                  class="multiple-selection-list__field-container"
                  [disabled]="checklistTemplateForm.controls.notifyAlarm.value !== 'y'"                
                >
                  <span class="label field__label">Modo de notificación</span>
                  <div
                    class="multiple-selection-list__list-options-container"
                    [ngStyle]="{
                      'border-color':
                      checklistTemplateForm.controls.notifyAlarm.value !== 'y'
                          ? 'var(--z-colors-page-button-disabled-border)'
                          : 'var(--theme-primary-300)'
                    }"
                  >
                    <div
                      *ngIf="loading"
                      class="multiple-selection-list__progress-container"
                    >
                      <mat-progress-spinner
                        mode="indeterminate"
                        color="primary"
                        class="multiple-selection-list__progress"
                        diameter="64"
                      >
                      </mat-progress-spinner>
                    </div>
                    <div          
                      class="multiple-selection-list__list-options-box no-selections"
                      *ngIf="alarmNotificationMode.items.length === 0 && !loading"
                    >
                      <span>No hay elementos a mostrar...</span>
                    </div>
                    <mat-selection-list
                      *ngIf="alarmNotificationMode?.items.length > 0 || loading"
                      class="multiple-selection-list__list-options-box"
                      [disabled]="
                        checklistTemplateForm.controls.notifyAlarm.value !== 'y'
                      "
                      name="multipleSelection"
                      (click)="handleChangeSelection($event)"
                      (keydown)="handleKeyDown($event)"
                      cdkScrollable
                    >
                      <mat-list-option
                        *ngFor="let item of alarmNotificationMode.items; let i = index"            
                        [value]="item.id"
                        (click)="handleNotifyModesSelectItem('alarm', checklistTemplateForm.controls.notifyAlarm, item)"
                        (keydown)="handleKeyDown($event)"
                        [selected]="!!item.selected"
                        checkboxPosition="before"
                        
                        color="primary"
                      >
                        <div class="multiple-selection-list__list-option-container">
                          <div class="multiple-selection-list__list-option">
                            {{ item.friendlyText }}
                          </div>
                        </div>
                      </mat-list-option>
                    </mat-selection-list>
                  </div>
                  <div
                    class="multiple-selection-list__search-container"        
                  >
                    <mat-hint
                      class="auto-complete__hint"
                      align="start"          
                    >
                      <span
                        *ngIf="alarmNotificationMode?.items.length > 0"
                        class="auto-complete__hint--normal"
                      >
                        Item(s): {{ alarmNotificationMode.items.length }}
                      </span>
                      <span 
                        *ngIf="alarmNotificationMode.items.length === 0"
                        class="auto-complete__hint--normal"
                      >
                        No hay items a mostrar...
                      </span>
                    </mat-hint>
                    <mat-hint
                      class="auto-complete__hint"
                      align="end"          
                    >
                      <span class="auto-complete__hint--normal">
                          Seleccionados en la lista: {{ alarmNotificationModeSelected }}
                      </span>
                    </mat-hint>
                  </div>
                </fieldset>
              </div>
              <div class="field-items">
                <fieldset
                  class="multiple-selection-list__field-container"
                  [disabled]="checklistTemplateForm.controls.notifyAlarm.value !== 'y'"                
                >
                  <span class="label field__label">Canal de notificación</span>
                  <div
                    class="multiple-selection-list__list-options-container"
                    [ngStyle]="{
                      'border-color':
                      checklistTemplateForm.controls.notifyAlarm.value !== 'y'
                          ? 'var(--z-colors-page-button-disabled-border)'
                          : 'var(--theme-primary-300)'
                    }"
                  >
                    <div
                      *ngIf="loading"
                      class="multiple-selection-list__progress-container"
                    >
                      <mat-progress-spinner
                        mode="indeterminate"
                        color="primary"
                        class="multiple-selection-list__progress"
                        diameter="64"
                      >
                      </mat-progress-spinner>
                    </div>
                    <div          
                      class="multiple-selection-list__list-options-box no-selections"
                      *ngIf="alarmNotificationChannels.items.length === 0 && !loading"
                    >
                      <span>No hay elementos a mostrar...</span>
                    </div>
                    <mat-selection-list
                      *ngIf="alarmNotificationChannels?.items.length > 0 || loading"
                      class="multiple-selection-list__list-options-box"
                      [disabled]="
                        checklistTemplateForm.controls.notifyAlarm.value !== 'y'
                      "
                      name="multipleSelection"
                      (click)="handleChangeSelection($event)"
                      (keydown)="handleKeyDown($event)"
                      cdkScrollable
                    >
                      <mat-list-option
                        *ngFor="let item of alarmNotificationChannels.items; let i = index"            
                        [value]="item.id"
                        (click)="handleNotifyChannelsSelectItem('alarm', checklistTemplateForm.controls.notifyAlarm, item)"
                        (keydown)="handleKeyDown($event)"
                        [selected]="!!item.selected"
                        checkboxPosition="before"
                        
                        color="primary"
                      >
                        <div class="multiple-selection-list__list-option-container">
                          <div class="multiple-selection-list__list-option">
                            {{ item.friendlyText }}
                          </div>
                        </div>
                      </mat-list-option>
                    </mat-selection-list>
                  </div>
                  <div
                    class="multiple-selection-list__search-container"        
                  >
                    <mat-hint
                      class="auto-complete__hint"
                      align="start"          
                    >
                      <span
                        *ngIf="alarmNotificationChannels.items.length > 0"
                        class="auto-complete__hint--normal"
                      >
                        Item(s): {{ alarmNotificationChannels.items.length }}
                      </span>
                      <span 
                        *ngIf="alarmNotificationChannels.items.length === 0"
                        class="auto-complete__hint--normal"
                      >
                        No hay items a mostrar...
                      </span>
                    </mat-hint>
                    <mat-hint
                      class="auto-complete__hint"
                      align="end"          
                    >
                      <span class="auto-complete__hint--normal">
                          Seleccionados en la lista: {{ alarmNotificationChannelsSelected }}
                      </span>
                    </mat-hint>
                  </div>
                </fieldset>
              </div>
              <div class="field-items">
                <fieldset
                  class="field__container"
                  style="min-width: 350px; height: calc(100% - 22px);"
                  [ngClass]="{
                    'field__container--error':
                      checklistTemplateForm.controls.alarmRecipient.touched &&
                      !checklistTemplateForm.controls.alarmRecipient.valid
                  }"
                  [disabled]="checklistTemplateForm.controls.alarmRecipient.disabled ||checklistTemplateForm.controls.notifyAlarm.value !== 'y'"
                >
                  <div class="title-with-id">
                    <span class="label field__label">Recipiente asociado</span>
                    <span class="field__label" *ngIf="checklistTemplateForm.controls.alarmRecipient?.value?.id">Id: {{ checklistTemplateForm.controls.alarmRecipient?.value?.id }}</span>
                  </div>
                  <app-auto-complete-field
                    [focused]="focusThisField==='alarmRecipient'"
                    [formField]="checklistTemplateForm.controls.alarmRecipient"
                    [list]="recipients.items"
                    [totalCount]="recipients.totalCount"
                    leftHint="Escriba el Nombre del recipiente a buscar"
                    [catalog]="SystemTables.RECIPIENTS"
                    [loading]="recipients.loading"
                    noItemsError="No hay recipientes con este nombre"
                    [showDataState]="true"
                    (optionSelected)="handleOptionSelected($event)"
                    (getMoreData)="getMoreData($event)"
                  >
                  </app-auto-complete-field>
                  <span class="field__help"
                    >Especifique el Recipiente a notificar</span
                  >
                </fieldset>
              </div> 
              <div
                class="field-items"
                [ngClass]="{ 
                  'field-items--bordered' : checklistTemplateForm.controls.alarmNotificationMessageBody.enabled,
                  'field-items--bordered-disabled' : checklistTemplateForm.controls.alarmNotificationMessageBody.disabled
                }"
              >
                <mat-icon
                  class="macros-icon"
                  svgIcon="transcode"
                  matTooltip="Este campo soporta macros"
                  matTooltipClass="tooltip-general"
                  matTooltipShowDelay="100"
                >
                </mat-icon>              
                <app-area-field
                  [bordered]="false"
                  [formField]="checklistTemplateForm.controls.alarmNotificationMessageBody"                
                  [fieldMaxLength]="1000"
                  [showRightHint]="true"
                  [showCloseButton]="true"
                  [minRows]="1"
                  [maxRows]="5"
                  fieldHelp="Especifique el mensaje que se enviará"
                >
                  <span fieldTitle class="label field__label"
                    >Notificación a enviar cuando el checklist se alarme</span
                  >
                </app-area-field>               
              </div> 
              <div
                class="field-items"
                [ngClass]="{ 
                  'field-items--bordered' : checklistTemplateForm.controls.alarmNotificationMessageSubject.enabled,
                  'field-items--bordered-disabled' : checklistTemplateForm.controls.alarmNotificationMessageSubject.disabled
                }"
              >
                <mat-icon
                  class="macros-icon"
                  svgIcon="transcode"
                  matTooltip="Este campo soporta macros"
                  matTooltipClass="tooltip-general"
                  matTooltipShowDelay="100"
                >
                </mat-icon>              
                <app-area-field
                  [bordered]="false"
                  [formField]="checklistTemplateForm.controls.alarmNotificationMessageSubject"
                  [fieldMaxLength]="200"
                  [showRightHint]="true"
                  [showCloseButton]="true"
                  [minRows]="1"
                  [maxRows]="5"
                  fieldHelp="Especifique el título de la notificación que se enviará por correo"
                >
                  <span fieldTitle class="label field__label"
                    >Título del mensaje a enviar cuando se alarme el checklist (sólo para envío de correos)</span
                  >
                </app-area-field>               
              </div> 
            </div>
          </mat-expansion-panel>
        </mat-expansion-panel>
        <mat-expansion-panel
          (opened)="panelOpenState[4] = true"
          (closed)="panelOpenState[4] = false"
          hideToggle="true"
          [expanded]="panelOpenState[4]"
        >
          <mat-expansion-panel-header
            [collapsedHeight]="'55px'"
            [ngStyle]="{
              'background-color': panelOpenState[4]
                ? 'var(--z-colors-page-shadow)'
                : 'var(--z-colors-page-card-background-color)'
            }"
          >
            <mat-panel-title>
              <mat-icon class="accordion-icon" svgIcon="attachment"> </mat-icon>              
              <div class="flex-accordion">
                <label class="accordion-label">ADJUNTOS DE LA PLANTILLA DE CHECKLIST / CABECERA</label>
                <label class="accordion-label-no-counter">({{ checklistTemplate.attachments.length }} de un máximo de {{ settingsData?.attachments?.checklistTemplateHeader ?? 10 }})</label>                
              </div>                
            </mat-panel-title>
            <div class="icon-button-container">
              <button
                mat-icon-button
                class="icon-button open"
                aria-label="icon-button with menu icon"
              >
                <mat-icon class="icon-button">
                  {{
                    panelOpenState[4]
                      ? "keyboard_arrow_up"
                      : "keyboard_arrow_down"
                  }}
                </mat-icon>
              </button>
            </div>
          </mat-expansion-panel-header>
          <div class="grid-multiple margin-top">            
            <div class="field-items">              
              <div            
                class="values-table values-table__container"    
              >              
                <table mat-table [dataSource]="attachmentsTable">

                  <ng-container matColumnDef="index">
                    <th mat-header-cell *matHeaderCellDef>#</th>                  
                    <td mat-cell *matCellDef="let row; let i = index">
                      <ng-container>{{ i + 1 }}</ng-container>    
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="icon">
                    <th mat-header-cell *matHeaderCellDef>Aplicación</th>
                    <td mat-cell *matCellDef="let row">
                      <div class="card-image-icon">
                        <div
                          class="image-container-table"
                          *ngIf="row.icon === 'field_image'"
                        >
                          <img                
                            @dissolve
                            appImageNotFound                
                            class="variable-image"    
                            [src]="row.image"
                            [alt]="row.image"         
                            fill
                          >      
                        </div>
                        <div
                          *ngIf="row.icon !== 'field_image'"
                          class="icon-container"
                        >
                          <mat-icon 
                            class="file-type-icon"
                            [svgIcon]="row.icon"
                          >
                          </mat-icon>
                        </div>    
                      </div>  
                    </td>      
                  </ng-container>

                  <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef>Nombre</th>                  
                    <td mat-cell *matCellDef="let row">
                      <ng-container>{{ row.name }}</ng-container>    
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="actions-attachments">
                    <th mat-header-cell *matHeaderCellDef>Acciones</th>
                    <td class="general-info" mat-cell *matCellDef="let row; let i = index">
                      <div
                        class="box-row"      
                      >
                        <button
                          mat-icon-button
                          (click)="handleAttachmentMoveToUp(i)"
                          matTooltip="Sube el item a un orden"
                          matTooltipClass="tooltip-general"
                          matTooltipShowDelay="100"
                          [disabled]="i === 0"
                        >
                          <mat-icon>keyboard_arrow_up</mat-icon>
                        </button>
                        <button
                          mat-icon-button
                          (click)="handleAttachmentMoveToDown(i)"
                          matTooltip="Baja el item a un orden"
                          matTooltipClass="tooltip-general"
                          matTooltipShowDelay="100"
                          [disabled]="i === checklistTemplate.attachments.length - 1"
                        >
                          <mat-icon>keyboard_arrow_down</mat-icon>
                        </button>
                        <button
                          mat-icon-button
                          (click)="handleAttachmentMoveToFirst(i)"
                          matTooltip="Sube el item al primer orden"
                          matTooltipClass="tooltip-general"
                          matTooltipShowDelay="100"
                          [disabled]="i === 0"
                        >
                          <mat-icon class="icon-rotated-90">first_page</mat-icon>
                        </button>
                        <button
                          mat-icon-button
                          (click)="handleAttachmentMoveToLast(i)"
                          matTooltip="Baja el item al último orden"
                          matTooltipClass="tooltip-general"
                          matTooltipShowDelay="100"
                          [disabled]="i === checklistTemplate.attachments.length - 1"
                        >
                          <mat-icon class="icon-rotated-90">last_page</mat-icon>
                        </button>
                        <button
                          mat-icon-button (click)="handleAttachmentRemove(i)"
                          matTooltip="Elimina este adjunto..."
                          matTooltipClass="tooltip-general"
                          matTooltipShowDelay="100"      
                        >      
                          <mat-icon>delete</mat-icon>
                        </button>
                        <button
                          mat-icon-button (click)="handleAttachmentDownload(i)"
                          matTooltip="Descarga a su disco una copia del archivo"
                          matTooltipClass="tooltip-general"
                          matTooltipShowDelay="100"      
                        >
                          <mat-icon>cloud_download</mat-icon>
                        </button>
                      </div>    
                    </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="attachmentsTableColumns; sticky: 1"></tr>
                  <tr class="table-row" mat-row *matRowDef="let row; columns: attachmentsTableColumns"></tr>
                  
                  <tr class="values-table-mat-row" *matNoDataRow>
                    <td class="values-table__no-data" colspan="9">
                      No hay adjuntos a mostrar...
                    </td>
                  </tr>                  
                </table>
              </div>        
              <mat-divider style="margin: 10px 0px 0px 0px;"></mat-divider>
              <div class="grid-multiple-rows no-flex">
                <div class="maintenance-buttons" style="padding: 10px 10px 1px 0px;">
                  <input type="file" style="display: none" (change)="onAttachmentFileSelected($event)" #fileInputAttachment> 
                  <button
                    [disabled]="addAttachmentButtonClick"
                    mat-button
                    class="toolbar-button"
                    aria-label="icon-button with menu icon"
                    matTooltip="Agrega un nuevo adjunto a la variablee"
                    matTooltipClass="tooltip-general"
                    matTooltipShowDelay="100"
                    (click)="(checklistTemplate.attachments.length >= (settingsData?.attachments?.checklistTemplateHeader ?? 10)) ? messageMaxAttachment() : fileInputAttachment.click();"
                  >
                    <mat-icon                                    
                      class="svgicon icon-medium"                
                      svgIcon="document"
                      [ngStyle]="{ visibility: addAttachmentButtonClick ? 'hidden' : 'visible' }"
                    >
                    </mat-icon>
                    <mat-progress-spinner
                      *ngIf="addAttachmentButtonClick"
                      class="spinner-regular-button"
                      diameter="32"
                      mode="indeterminate"
                    >
                    </mat-progress-spinner>
                    <mat-label class="button-label">Agregar un adjunto...</mat-label>
                  </button>          
                  <button
                    [disabled]="checklistTemplate.attachments.length === 0"
                    mat-button
                    class="toolbar-button warn"
                    aria-label="icon-button with menu icon"
                    matTooltip="Elimina todos los adjuntos"
                    matTooltipClass="tooltip-general"
                    matTooltipShowDelay="100"
                    (click)="handleRemoveAllAttachments()"
                  >
                    <mat-icon                
                      class="svgicon icon-medium"                
                      svgIcon="garbage_can"
                    >
                    </mat-icon>  
                    <mat-label class="button-label">Eliminar todos los adjuntos...</mat-label>
                  </button>      
                  <app-label-ellipsis
                    class="readonly-value"
                    style="margin-left: auto"     
                    [lines]="1"
                    [labelInnerHTML]="checklistTemplateAttachmentLabel"
                  ></app-label-ellipsis>              
                </div>
              </div>      
            </div>
          </div>
        </mat-expansion-panel>
        <mat-expansion-panel
          (opened)="panelOpenState[5] = true"
          (closed)="panelOpenState[5] = false"
          hideToggle="true"
          [expanded]="panelOpenState[5]"
          class="control-panel-accent"
        >
          <mat-expansion-panel-header
            [collapsedHeight]="'55px'"
            [ngStyle]="{
              'background-color': panelOpenState[5]
                ? 'var(--z-colors-page-shadow)'
                : 'var(--z-colors-page-card-background-color)'
            }"
          >
            <mat-panel-title>
              <mat-icon class="accordion-icon" svgIcon="view_mode_details"> </mat-icon>
              <div class="flex-accordion">
                <label class="accordion-label">LÍNEAS DEL CHECKLIST / VARIABLES</label>
                <label class="accordion-label-no-counter">({{ checklistTemplateLines.length }} de un máximo de {{ settingsData?.checklistTemplate?.variablesLimit ?? 20 }})</label>                
              </div>                
            </mat-panel-title>
            <div class="icon-button-container">
              <button
                mat-icon-button
                class="icon-button open"
                aria-label="icon-button with menu icon"
              >
                <mat-icon class="icon-button">
                  {{
                    panelOpenState[5]
                      ? "keyboard_arrow_up"
                      : "keyboard_arrow_down"
                  }}
                </mat-icon>
              </button>
            </div>
          </mat-expansion-panel-header>    
          <div class="grid-multiple margin-top">          
            <button
              [disabled]="addVariableButtonClick"
              mat-button
              class="toolbar-button"
              aria-label="icon-button with menu icon"
              matTooltip="Agrega una nueva variable"
              matTooltipClass="tooltip-general"
              matTooltipShowDelay="100"
              (click)="addVariable()"
            >
              <mat-icon                                    
                class="svgicon icon-medium"                
                svgIcon="equation_add"
                [ngStyle]="{ visibility: addVariableButtonClick ? 'hidden' : 'visible' }"
              >
              </mat-icon>
              <mat-progress-spinner
                *ngIf="addVariableButtonClick"
                class="spinner-regular-button"
                diameter="32"
                mode="indeterminate"
              >
              </mat-progress-spinner>
              <mat-label class="button-label">Agregar una línea al checklist...</mat-label>
            </button>
          </div>          
          <ng-container *ngFor="let line of checklistTemplateLines; let i = index">
            <div
              class="variable-panel"
              [ngStyle]="{ 'order': line.order }"              
            >
              <mat-expansion-panel
                (opened)="formPanelOpenState[i] = true"
                (closed)="formPanelOpenState[i] = false"
                hideToggle="true"
                [expanded]="formPanelOpenState[i]"
                style="margin: 5px"            
                [ngClass]="{ 
                  'control-panel-disabled': checklistTemplateLines[i].status === RecordStatus.INACTIVE,
                  'control-panel-warn': checklistTemplateLines[i].error,
                  'control-panel-animated': line.order === movedVariable
                } "                
              >
                <mat-expansion-panel-header              
                  [collapsedHeight]="'55px'"
                  [ngStyle]="{
                    'background-color': formPanelOpenState[i]
                      ? 'var(--z-colors-page-shadow)'
                      : 'var(--z-colors-page-card-background-color)'
                  }"
                >
                  <mat-panel-title>            
                    <mat-icon class="accordion-icon" svgIcon="equation"> </mat-icon>
                    <div class="accordion-label-no-counter">
                      {{ line.order + 1 }} de {{ checklistTemplateLines.length }}: <strong>{{ line.name }}</strong>
                    </div>
                  </mat-panel-title>  
                  <div
                    class="box-row-variable"      
                  >
                    <button
                      class="variable-button"
                      mat-icon-button
                      (click)="$event.stopPropagation();handleVariableMoveToUp(i)"
                      matTooltip="Sube la línea (variable) a un orden"
                      matTooltipClass="tooltip-general"
                      matTooltipShowDelay="100"
                      [disabled]="line.order === 0"
                    >
                      <mat-icon>keyboard_arrow_up</mat-icon>
                    </button>
                    <button
                      class="variable-button"
                      mat-icon-button
                      (click)="$event.stopPropagation();handleVariableMoveToDown(i)"
                      matTooltip="Baja la línea (variable) a un orden"
                      matTooltipClass="tooltip-general"
                      matTooltipShowDelay="100"
                      [disabled]="line.order === checklistTemplateLines.length - 1"
                    >
                      <mat-icon>keyboard_arrow_down</mat-icon>
                    </button>
                    <button
                      class="variable-button"
                      mat-icon-button
                      (click)="$event.stopPropagation();handleVariableMoveToFirst(i)"
                      matTooltip="Sube la línea (variable) al primer orden"
                      matTooltipClass="tooltip-general"
                      matTooltipShowDelay="100"
                      [disabled]="line.order === 0"
                    >
                      <mat-icon class="icon-rotated-90">first_page</mat-icon>
                    </button>
                    <button
                      class="variable-button"
                      mat-icon-button
                      (click)="$event.stopPropagation();handleVariableMoveToLast(i)"
                      matTooltip="Baja la línea (variable) al último orden"
                      matTooltipClass="tooltip-general"
                      matTooltipShowDelay="100"
                      [disabled]="line.order === checklistTemplateLines.length - 1"
                    >
                      <mat-icon class="icon-rotated-90">last_page</mat-icon>
                    </button>                    
                  </div>
                  
                  <div class="icon-button-container">
                    <button
                      mat-icon-button
                      class="icon-button open"
                      aria-label="icon-button with menu icon"
                    >
                      <mat-icon class="icon-button">
                        {{
                          formPanelOpenState[i]
                            ? "keyboard_arrow_up"
                            : "keyboard_arrow_down"
                        }}
                      </mat-icon>
                    </button>
                  </div>                  
                </mat-expansion-panel-header>                                
                <div class="grid-multiple margin-top">
                  <button
                    [disabled]="line.loading"
                    mat-button
                    class="toolbar-button"
                    aria-label="icon-button with menu icon"
                    matTooltip="Actualiza los datos de la variable"
                    matTooltipClass="tooltip-general"
                    matTooltipShowDelay="100"
                    (click)="handleRefreshVariable(i)"
                  >
                    <mat-icon                                    
                      class="svgicon icon-medium"                
                      svgIcon="equation_refresh"
                      [ngStyle]="{ visibility: line.loading ? 'hidden' : 'visible' }"
                    >
                    </mat-icon>
                    <mat-progress-spinner    
                      *ngIf="line.loading"
                      class="spinner-regular-button"
                      diameter="32"
                      mode="indeterminate"
                    >
                    </mat-progress-spinner>
                    <mat-label class="button-label">Actualizar la variable...</mat-label>
                  </button>

                  <button
                    *ngIf="line.status === RecordStatus.ACTIVE"
                    [disabled]="line.loading"
                    mat-button
                    class="toolbar-button"
                    aria-label="icon-button with menu icon"
                    matTooltip="Inactiva la variable"
                    matTooltipClass="tooltip-general"
                    matTooltipShowDelay="100"
                    (click)="handleInactivateVariable(i)"
                  >
                    <mat-icon                                    
                      class="svgicon icon-medium"                
                      svgIcon="equation_inactivate"
                      [ngStyle]="{ visibility: line.loading ? 'hidden' : 'visible' }"
                    >
                    </mat-icon>
                    <mat-progress-spinner   
                      *ngIf="line.loading"                   
                      class="spinner-regular-button"
                      diameter="32"
                      mode="indeterminate"
                    >
                    </mat-progress-spinner>
                    <mat-label class="button-label">Inactivar la variable...</mat-label>
                  </button>

                  <button
                    *ngIf="line.status === RecordStatus.INACTIVE"
                    [disabled]="line.loading"
                    mat-button
                    class="toolbar-button"
                    aria-label="icon-button with menu icon"
                    matTooltip="Inactiva la variable"
                    matTooltipClass="tooltip-general"
                    matTooltipShowDelay="100"
                    (click)="handleReactivateVariable(i)"
                  >
                    <mat-icon                                    
                      class="svgicon icon-medium"                
                      svgIcon="equation_reactivate"
                      [ngStyle]="{ visibility: line.loading ? 'hidden' : 'visible' }"
                    >
                    </mat-icon>
                    <mat-progress-spinner   
                      *ngIf="line.loading"                   
                      class="spinner-regular-button"
                      diameter="32"
                      mode="indeterminate"
                    >
                    </mat-progress-spinner>
                    <mat-label class="button-label">Reactivar la variable...</mat-label>
                  </button>

                  <button
                    [disabled]="line.loading"
                    mat-button
                    class="toolbar-button warn"
                    aria-label="icon-button with menu icon"
                    matTooltip="Remueve la variable"
                    matTooltipClass="tooltip-general"
                    matTooltipShowDelay="100"
                    (click)="handleRemoveVariable(i)"
                  >
                    <mat-icon                                    
                      class="svgicon icon-medium"                
                      svgIcon="equation_remove"
                      [ngStyle]="{ visibility: line.loading ? 'hidden' : 'visible' }"
                    >
                    </mat-icon>
                    <mat-progress-spinner     
                      *ngIf="line.loading"                 
                      class="spinner-regular-button"
                      diameter="32"
                      mode="indeterminate"
                    >
                    </mat-progress-spinner>
                    <mat-label class="button-label">Quitar la variable...</mat-label>
                  </button>
                </div>
                <mat-divider style="margin: 5px 10px 0px 10px;"></mat-divider>
                <div class="grid-multiple">
                  <app-checklist-template-edition-line
                    [line]="line"                                        
                    [updatingCount]="updatingCount"
                    class="checklist-template-line"
                    (formChange)="handleLineFormChange($event)"
                  >
                  </app-checklist-template-edition-line>
                </div>  
              </mat-expansion-panel>                  
            </div>
          </ng-container>          
        </mat-expansion-panel>           
      </mat-accordion>
    </form>
    <div
      *ngIf="checklistTemplate.id"
      class="catalog-footer"
    >
      <div class="grid-dates">
        <div class="flex">
          <div class="readonly-value item-id">{{ checklistTemplate.id }}</div>
          <div class="label-with-no-index">ID del registro</div>
        </div>
        <div class="flex">
          <div class="readonly-value">{{ _sharedService.convertUtcTolocal(checklistTemplate.createdAt) | date :"medium" }}</div>
          <div class="flex-row">
            <mat-icon class="small-icon" svgIcon="event"></mat-icon>
            <div class="label-with-no-index">Fecha de creación</div>
          </div>
        </div>
        <div class="flex">
          <div class="readonly-value">{{ checklistTemplate.createdBy?.name ?? ScreenDefaultValues.N_A }}</div>
          <div class="flex-row">
            <mat-icon class="small-icon" svgIcon="man"></mat-icon>
            <div class="label-with-no-index">Creado por</div>
          </div>
        </div>
        <div class="flex">
          <div class="readonly-value">{{ _sharedService.convertUtcTolocal(checklistTemplate.updatedAt) | date :"medium" }}</div>
          <div class="flex-row">
            <mat-icon class="small-icon" svgIcon="event"></mat-icon>
            <div class="label-with-no-index">Fecha de modificación</div>
          </div>
        </div>
        <div class="flex">
          <div class="readonly-value">{{ checklistTemplate.updatedBy?.name ?? ScreenDefaultValues.N_A }}</div>
          <div class="flex-row">
            <mat-icon class="small-icon" svgIcon="man"></mat-icon>
            <div class="label-with-no-index">Modificado por</div>
          </div>
        </div>


        <div class="flex">
          <div class="readonly-value">{{ checklistTemplate.lastGeneratedDate ? (_sharedService.convertUtcTolocal(checklistTemplate.lastGeneratedDate) | date :"medium") : "Indeterminado..." }}</div>
            <div class="flex-row">
              <mat-icon class="small-icon" svgIcon="event"></mat-icon>
              <div class="label-with-no-index">Fecha de últ. generación</div>
          </div>
        </div>
        <div class="flex">
          <div class="readonly-value item-id">{{ (checklistTemplate.generationCount ? checklistTemplate.generationCount : 0) | number : "1." }}</div>
            <div class="flex-row">
              <mat-icon class="small-icon" svgIcon="update"></mat-icon>
              <div class="label-with-no-index">Checklist generados</div>
          </div>
        </div>
      </div>
      <mat-divider></mat-divider>
      <div class="grid-inactive" *ngIf="checklistTemplate.status === RecordStatus.INACTIVE">
        <div class="flex">
          <div class="readonly-value">{{ _sharedService.convertUtcTolocal(checklistTemplate.deletedAt) | date :"medium" }}</div>
          <div class="flex-row">
            <mat-icon class="small-icon" svgIcon="event"></mat-icon>
            <div class="label-with-no-index">Fecha de inactivación</div>
          </div>
        </div>
        <div class="flex">
          <div class="readonly-value">{{ checklistTemplate.deletedBy?.name ?? ScreenDefaultValues.N_A }}</div>
          <div class="flex-row">
            <mat-icon class="small-icon" svgIcon="man"></mat-icon>
            <div class="label-with-no-index">Inactivado por</div>
          </div>
        </div>
        <div class="flex-inactive">
          <div class="label-inactive">
            <strong>El registro está INACTIVO</strong>
          </div>
        </div>
      </div>
    </div>
  </mat-card>
</div>